"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1471],{48298:(e,t,i)=>{i.d(t,{kn:()=>p,kj:()=>g,Tr:()=>m});var o=i(58129),r=i(90468),a=i(19889),n=i(50906),s=i(54642),d=i(10279),c=i(9953),l=i(30149),h=i(3815),u=i(98905);const p=async e=>{const{environment:t,store:i,accessRequestStore:o,forActor:r,status:s,from:h}=e,u=t.currentUser.id;if("approved"===s){const e={type:"existingUser",value:r,spaceRole:"read_and_write"};if(!(await d.n_({environment:t,store:i,inviteTargets:[e],inviteRole:"read_and_write",isOnboarding:!1,invite:{inviteOrigin:"membership_request"}})).success)return}l.createAndCommit({userAction:"GrantAccessActivityAction.handleGrantAccess",environment:t,perform:e=>{c.sW({store:o,transaction:e,data:{granted_time:Date.now(),granted_by_table:a.KJ,granted_by_id:u,resolved_time:Date.now(),resolved_by_table:a.KJ,resolved_by_id:u,status:s}})}}),n.trackResolveMembershipRequest(t,{status:s,request_id:o.id,from:h,for_actor_id:r.id,space_role:i.getRole()})};async function g(e){if(u.Z.reset(),!e.canAdmin)return;const{environment:t,spaceId:i}=e,o=await s.getUnreadAccessRequestCount(t,{parentTable:r.bx,parentId:i,size:1});"success"===o.type&&u.Z.setState({spaceId:i,count:o.data.count})}function m(e,t){const i=new Map;for(const r of t){const t=(0,h.Kv)(e,{table:o.J8,id:r}),n=t.getValue();if(!n)continue;if(n.for_actor_table!==a.KJ||n.created_by_table!==a.KJ)continue;const s=(0,h.Kv)(e,{table:n.for_actor_table,id:n.for_actor_id}).getValue();if(!s)continue;const d=(0,h.Kv)(e,{table:n.created_by_table,id:n.created_by_id}).getValue();if(d)if(i.has(n.for_actor_id)){const e=i.get(n.for_actor_id);if(!e)continue;n.created_time>e.latestRequestTime?i.set(n.for_actor_id,{...e,createdByActorsWithReason:[{actor:d,reason:n.message},...e.createdByActorsWithReason],accessRequest:n,accessRequestStore:t,latestRequestTime:n.created_time}):i.set(n.for_actor_id,{...e,createdByActorsWithReason:[...e.createdByActorsWithReason,{actor:d,reason:n.message}]})}else i.set(n.for_actor_id,{forActor:s,createdByActorsWithReason:[{actor:d,reason:n.message}],accessRequest:n,accessRequestStore:t,latestRequestTime:n.created_time})}return Array.from(i.values())}},35660:(e,t,i)=>{i.r(t),i.d(t,{default:()=>_i});var o=i(97464),r=i.n(o),a=i(77094),n=i.n(a),s=i(96486),d=i.n(s),c=i(67294),l=i(83355),h=i(40902),u=i(66897),p=i(15145),g=i(82813),m=i(41432),v=i(39068),f=i(59753),b=i(55061),y=i(89101),S=i(21202),A=i(77420),M=i(6287),k=i(13493),w=i(70279),_=i(33709),O=i(90468),T=i(19889),R=i(99108),C=i(97880),I=i(82990),B=i(64002),J=i(5366),D=i(50906),N=i(19719),P=i(17659),V=i(30149),x=i(51456),L=i(67669),Z=i(3815),K=i(4761),U=i(480),E=i(81954),F=i(24405),q=i(58129),G=i(29369),z=i(4708),W=i(33929),H=i(8848),$=i(3779),j=i(51118),Y=i(43250),X=i(12534),Q=i(16402),ee=i(12318),te=i(73063),ie=i(86176),oe=i(58032),re=i(70301),ae=i(45653),ne=i(67706);function se(e){let{notification:t,rootStore:i,onArchiveClicked:o,onMarkAsReadClicked:a,onMarkAsUnreadClicked:s}=e;window.__c={n:"InboxActionsMenu"};const d=(0,U.O7)(),l=(0,c.useCallback)((e=>{t&&(0,X.ZP)({event:e,context:X.Af.NotificationClick,callback:()=>{o(),V.createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:d,perform:e=>{P.aZ({notification:t,rootStore:i,transaction:e})}})}})}),[d,t,o,i]),h=(0,c.useCallback)((e=>{t&&(0,X.ZP)({event:e,context:X.Af.NotificationClick,callback:()=>{t.read?s():a(),V.createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:d,perform:e=>{P.$h({notification:t,rootStore:i,transaction:e,read:!t.read})}})}})}),[d,t,a,s,i]),{isMobile:u}=d.device,p=(0,F.yK)((e=>({container:{display:"flex",height:"min-content",background:e.buttonGroupBackground,boxShadow:e.lightBoxShadow,borderRadius:4,padding:2},button:{height:u?30:26,width:u?30:26},iconStyle:{fill:e.mediumTextColor,padding:2},readIcon:{width:u?21:19,height:u?22:20},archiveIcon:{width:u?24:23,height:u?24:23}})),[u]);return t?n()("div",{style:p.container},void 0,n()(oe.Z,{renderTooltip:()=>t.read?n()(J.FormattedMessage,{defaultMessage:"Mark this notification as unread",id:"inboxActionsMenu.markNotificationAsUnread.tooltipMessage",description:"Tooltip message for the icon button to mark a notification as unread. The icon is an image of an empty speech bubble."}):n()(J.FormattedMessage,{defaultMessage:"Mark this notification as read",id:"inboxActionsMenu.markNotificationAsRead.tooltipMessage",description:"Tooltip message for the icon button to mark a notification as read. The icon is an image of a speech bubble with a checkmark in it."}),render:e=>c.createElement(te.Z,r()({style:p.button,icon:t.read?$.Z.notificationUnread:$.Z.notificationRead,iconStyle:{...p.iconStyle,...p.readIcon},onClick:h},e))}),n()(oe.Z,{renderTooltip:()=>n()(J.FormattedMessage,{defaultMessage:"Archive this notification",id:"inboxActionsMenu.handleArchive.tooltipMessage",description:"Tooltip message for the icon button to archive a notification. The icon is an image of a storage file box."}),render:e=>c.createElement(te.Z,r()({style:p.button,icon:$.Z.archive,iconStyle:{...p.iconStyle,...p.archiveIcon},onClick:l},e))})):null}const de=c.memo(se);var ce=i(32469),le=i(93963);class he extends l.Z{constructor(){super(...arguments),this.storeTypes={hovered:ee.default.of(!1),hoveredOverInboxActionsMenu:ee.default.of(!1)},this.handleMouseOver=()=>{this.stores.hovered.set(!0)},this.handleMouseLeave=()=>{this.stores.hovered.set(!1)},this.handleMouseEnterInboxActions=()=>{this.stores.hoveredOverInboxActionsMenu.set(!0)},this.handleMouseLeaveInboxActions=()=>{this.stores.hoveredOverInboxActionsMenu.set(!1)},this.handleArchive=()=>{const{notification:e,rootStore:t,onArchiveClicked:i}=this.props;i(),e&&V.createAndCommit({userAction:"ActivitySection.handleArchive",environment:this.environment,perform:i=>{P.aZ({notification:e,rootStore:t,transaction:i})}})},this.handleMarkAsRead=e=>{const{notification:t,rootStore:i,onNotificationFrameClicked:o}=this.props;t&&!t.read&&(this.stores.hoveredOverInboxActionsMenu.get()||(0,X.ZP)({event:e,context:X.Af.NotificationClick,callback:()=>{o(),V.createAndCommit({userAction:"ActivitySection.handleMarkAsRead",environment:this.environment,perform:e=>{P.$h({notification:t,rootStore:i,transaction:e,read:!0})}})}}))},this.handleOpenSnapshot=()=>{if(this.props.navigableBlockId){const e=Z.G.createChildStore(this.props.rootStore,{table:S.iU,id:this.props.navigableBlockId});j.jN({environment:this.environment,blockStore:e,openSnapshotNearTimestamp:this.props.timestamp.toString(),from:"activity"})}}}renderComponent(){const{children:e}=this.props,t="mentions"===K.ZP.state.currentTab;return n()("div",{onMouseOver:this.handleMouseOver,onMouseLeave:this.handleMouseLeave,onClick:this.handleMarkAsRead},void 0,this.renderInboxActions(),n()("div",{style:{...he.wrapStyle,paddingBottom:e?12:8,paddingLeft:this.environment.device.isMobile?this.environment.WindowSizeStore.state.paddingLeftCSS:0,paddingRight:this.environment.device.isMobile?this.environment.WindowSizeStore.state.paddingRightCSS:0,...this.shouldShowReadNotificationStyle()&&{opacity:.7}}},void 0,n()("div",{style:this.getHeaderAndAvatarStyle()},void 0,n()("div",{className:Y.FoE,style:this.avatarAndStatusDotStyle()},void 0,n()("div",{style:{marginRight:4}},void 0,t&&n()("div",{style:{marginRight:this.environment.device.isMobile?3:2}},void 0,this.renderStatusDot({opacity:1}))),this.props.icon),this.renderHeader(),this.renderSnapshotButton(),this.renderPrivate()),e&&this.renderChildren()),this.renderDivider())}renderDivider(){const{isLast:e}=this.props;if(!e)return n()("div",{style:this.getBorderBottomStyle()})}renderHeader(){const{timestamp:e,header:t}=this.props,i=(0,Q.IS)(e),o=(0,Q.uy)(e);return n()("div",{style:he.headerStyle},void 0,n()("div",{className:Y.NFf},void 0,t),n()("div",{style:{display:"flex",marginTop:4,marginBottom:this.props.children?8:4}},void 0,n()("div",{style:this.getTimeStyle(),className:Y.CZG},void 0,n()(ne.Z,{text:i,tooltipText:o,icon:$.Z.calendar})),this.props.navigableBlockId&&this.props.rootStore&&n()(ie.Z,{isLink:!0,innerStyle:this.getPathStyle(),store:Z.G.createChildStore(this.props.rootStore,{table:S.iU,id:this.props.navigableBlockId}),left:n()("div",{style:this.getSeparatorDotStyle()},void 0,"·"),onClick:this.props.onBacklinkClicked})))}renderSnapshotButton(){if(!this.props.showSnapshotButton)return;if(this.props.timestamp<new Date("2018-10-26").getTime())return;const e=W.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"});return this.props.navigableBlockId?n()(oe.Z,{renderTooltip:()=>e,render:t=>c.createElement(te.Z,r()({ariaLabel:e,onClick:this.handleOpenSnapshot,icon:$.Z.versionHistoryThick},t))}):void 0}renderInboxActions(){const{notification:e,rootStore:t,onArchiveClicked:i,onMarkAsReadClicked:o,onMarkAsUnreadClicked:r}=this.props,{currentTab:a}=K.ZP.state;if("mentions"===a&&e&&!e.visited)return n()("div",{style:this.getStatusLabelContainerStyle(),onMouseEnter:this.handleMouseEnterInboxActions,onMouseLeave:this.handleMouseLeaveInboxActions},void 0,n()("div",{style:this.getInboxActionsStyle()},void 0,n()(de,{notification:e,rootStore:t,onArchiveClicked:i,onMarkAsReadClicked:o,onMarkAsUnreadClicked:r})))}renderStatusDot(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!this.isSeen()&&n()(le.z,{style:{...this.getStatusDotStyle(),...e}})}renderPrivate(){if(this.props.isPrivate&&!this.props.notification)return n()(ce.Z,{style:{marginTop:1,marginBottom:4,marginLeft:8}})}renderChildren(){return n()("div",{className:Y.nU_},void 0,this.props.children)}isSeen(){const{notification:e}=this.props;return!e||e.read}shouldShowReadNotificationStyle(){const{currentTab:e}=K.ZP.state;return this.isSeen()&&"mentions"===e&&!this.props.showSnapshotButton&&this.props.notification}avatarAndStatusDotStyle(){return{display:"flex",alignItems:"flex-start",position:"relative"}}getHeaderAndAvatarStyle(){return{display:"flex",paddingLeft:16,paddingRight:16+("mentions"!==K.ZP.state.currentTab||this.props.showSnapshotButton?0:69)}}getBorderBottomStyle(){return{borderBottom:`1px solid ${this.theme.regularDividerColor}`}}getPathStyle(){return{fontSize:12,color:this.theme.lightTextColor}}getTimeStyle(){return{fontSize:12,color:this.theme.lightTextColor,whiteSpace:"nowrap"}}getSeparatorDotStyle(){return{fontSize:12,color:this.theme.lightTextColor,marginLeft:4,marginRight:4}}getStatusLabelContainerStyle(){return{display:"flex",alignItems:"flex-start",marginTop:1,marginBottom:4,position:"relative",marginLeft:this.environment.device.isMobile?23:8}}getStatusDotStyle(){return{position:"absolute",opacity:this.stores.hovered.get()?0:1,left:-7,top:10}}getInboxActionsStyle(){const{isMobile:e}=this.environment.device;return{transition:"opacity 100ms ease-out",opacity:e||this.stores.hovered.get()?1:0,position:"absolute",right:16,top:12,zIndex:1}}}he.displayName="ActivitySection",he.wrapStyle={paddingTop:12},he.headerStyle={fontSize:14,lineHeight:1.4,flexGrow:1,minWidth:0};const ue={marginTop:2,marginRight:8,flexShrink:0};function pe(e){const{authors:t}=e,i=t[0];return i&&(0,u.z8)(i)?n()(re.Z,{botValue:i.value,style:ue,size:24}):n()(ae.Z,{userValue:i&&i.value,style:ue,size:24,avatarShouldShowShadow:!0})}function ge(){return window.__c={n:"ReminderIcon"},n()("div",{style:{display:"flex",backgroundColor:H.ZP.red,height:28,width:28,borderRadius:"100%",...ue}},void 0,$.Z.alarmClock({height:16,width:16,fill:H.ZP.white,marginLeft:6,marginTop:5}))}function me(){return window.__c={n:"VerificationIcon"},n()("div",{style:{height:25,width:25,...ue}},void 0,$.Z.typesVerification({height:25,width:25}))}const ve=he;function fe(e){window.__c={n:"ActivitySectionRedesignedIA"};const[t,i]=(0,c.useState)(!1),[o,r]=(0,c.useState)(!1),{notification:a,prominentTitleLink:s,children:d,rootStore:l,icon:h,isPrivate:u,isLast:p,onArchiveClicked:g,onNotificationFrameClicked:m,onMarkAsReadClicked:v,onMarkAsUnreadClicked:f,navigableBlockId:b,showSnapshotButton:y,timestamp:S,header:A}=e,M=(0,U.O7)(),k=(0,E.VK)((()=>"mentions"===K.ZP.state.currentTab),[]),w=!a||a.read,_=M.device.isMobile,O=Boolean(w&&k&&!y&&a),T=(0,E.VK)((()=>{const e=M.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[M.WindowSizeStore]),R=(0,F.yK)((e=>({container:{paddingTop:12,paddingBottom:d?12:8,paddingLeft:_?T.left:0,paddingRight:_?T.right:0,...O&&{opacity:.7}},headerAndAvatar:{display:"flex",paddingLeft:16,paddingRight:16},avatarAndStatusDot:{display:"flex",alignItems:"flex-start",position:"relative"},statusDot:{position:"absolute",opacity:1,left:-7,top:10},statusDotWrapper:{marginRight:_?3:2},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},divider:{borderBottom:`1px solid ${e.regularDividerColor}`}})),[d,T,_,O]),C=(0,c.useCallback)((e=>{a&&!a.read&&(o||(0,X.ZP)({event:e,context:X.Af.NotificationClick,callback:()=>{m(),V.createAndCommit({userAction:"ActivitySectionRedesignedIA.handleMarkAsRead",environment:M,perform:e=>{P.$h({notification:a,rootStore:l,transaction:e,read:!0})}})}}))}),[M,o,a,m,l]),I=(0,c.useCallback)((()=>i(!0)),[]),B=(0,c.useCallback)((()=>i(!1)),[]);return n()("div",{onMouseOver:I,onMouseLeave:B,onClick:C},void 0,n()(be,{notification:a,rootStore:l,isMobile:_,isHovered:t,isMentionsTab:k,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),onArchiveClicked:g,onMarkAsReadClicked:v,onMarkAsUnreadClicked:f}),n()("div",{style:R.container},void 0,n()("div",{style:R.headerAndAvatar},void 0,n()("div",{className:Y.FoE,style:R.avatarAndStatusDot},void 0,n()("div",{style:{marginRight:4}},void 0,k&&n()("div",{style:R.statusDotWrapper},void 0,!w&&n()(le.z,{style:R.statusDot}))),h),n()(ye,{timestamp:S,header:A,prominentTitleLink:s,hasChildren:Boolean(d)}),y&&b&&n()(Se,{timestamp:S,navigableBlockId:b,rootStore:l}),u&&!a&&n()(ce.Z,{style:R.privatePageBadge})),d&&n()("div",{className:Y.nU_},void 0,d)),!p&&n()("div",{style:R.divider}))}function be(e){window.__c={n:"InboxActions"};const{notification:t,rootStore:i,isMobile:o,isHovered:r,isMentionsTab:a,onArchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:c,onMouseEnter:l,onMouseLeave:h}=e,u=(0,F.yK)((()=>({container:{display:"flex",alignItems:"flex-start",marginTop:1,marginBottom:4,position:"relative",marginLeft:o?23:8},body:{transition:"opacity 100ms ease-out",opacity:o||r?1:0,position:"absolute",right:16,top:12,zIndex:1}})),[o,r]);return a&&t?t.visited?null:n()("div",{style:u.container,onMouseEnter:l,onMouseLeave:h},void 0,n()("div",{style:u.body},void 0,n()(de,{notification:t,rootStore:i,onArchiveClicked:s,onMarkAsReadClicked:d,onMarkAsUnreadClicked:c}))):null}function ye(e){window.__c={n:"Header"};const{timestamp:t,prominentTitleLink:i,header:o,hasChildren:r}=e,a=(0,Q.IS)(t,{useCompactFormat:!0}),s=(0,Q.uy)(t),d=(0,F.yK)((e=>({container:{width:"100%"},header:{fontSize:14,lineHeight:1.4,minWidth:0,display:"flex",alignItems:"baseline"},title:{fontSize:14,marginTop:4,marginBottom:r?8:4},spacer:{flexGrow:1,minWidth:20},time:{fontSize:12,color:e.lightTextColor,whiteSpace:"nowrap"},path:{fontSize:12,color:e.lightTextColor},separatorDot:{fontSize:12,color:e.lightTextColor,marginLeft:4,marginRight:4}})),[r]);return n()("div",{style:d.container},void 0,n()("div",{style:d.header},void 0,n()("div",{className:Y.NFf},void 0,o),n()("div",{style:d.spacer}),n()("div",{style:d.time,className:Y.CZG},void 0,n()(ne.Z,{text:a,tooltipText:s,icon:$.Z.calendar}))),i&&n()("div",{style:d.title},void 0,i))}function Se(e){window.__c={n:"SnapshotButton"};const{timestamp:t,navigableBlockId:i,rootStore:o}=e,a=(0,U.O7)();if(t<new Date("2018-10-26").getTime())return null;const s=W.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),d=()=>{const e=Z.G.createChildStore(o,{table:S.iU,id:i});j.jN({environment:a,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return n()(oe.Z,{renderTooltip:()=>s,render:e=>c.createElement(te.Z,r()({ariaLabel:s,onClick:d,icon:$.Z.versionHistoryThick},e))})}const Ae=c.memo(fe);var Me=i(24211),ke=i(61784),we=i(48298),_e=i(91376),Oe=i(64404),Te=(i(41892),i(76725)),Re=i(63306);class Ce extends c.PureComponent{render(){const{href:e}=this.props;return n()("a",{href:(0,B.Nm)({str:e,allowNoProtocol:!0}),style:this.getStyle(),className:"notion-email-button-hover"},void 0,this.props.children)}getStyle(){return{display:this.props.inline?"inline":"block",color:H.ZP.inherit,textDecoration:"none",cursor:"pointer",...this.props.style}}}const Ie=Ce;class Be extends c.PureComponent{render(){const e=this.getPathWithoutDomain();return e.length>0?n()("div",{},void 0,this.props.left,(0,Te.Z)(e,(e=>n()("span",{style:{paddingLeft:4,paddingRight:4}},`slash:${e}`,"/"))),this.props.right):null}getPathWithoutDomain(){const{getRecordValue:e,blockId:t,intl:i}=this.props,o=Re.uJ({table:"block",id:t},e),r=f.om.fromGetRecordValueFn(e);return d().initial(o.reverse()).map((e=>{const t=f.kk.fromBlock(e),o=t.getRenderTitle({getRecordModel:r,userTimeZone:this.props.userTimeZone,intl:i})||i.formatMessage({id:"recordPath.untitledBlock.placeholder",defaultMessage:"Untitled"}),a=t.getRenderUrl({getRecordModel:r});return n()(Ie,{href:`${this.props.baseUrl}${a}`,style:{display:"inline-block",maxWidth:120,verticalAlign:"top",...I.Z.textOverflowStyle}},e.id,o)}))}}const Je=(0,J.injectIntl)(Be);i(43593),i(17755),i(58102);c.PureComponent;class De extends c.PureComponent{constructor(){super(...arguments),this.theme=(0,H.gh)({theme:"light"})}render(){const{children:e}=this.props;return n()("table",{style:{paddingTop:12,paddingBottom:e?0:8,borderSpacing:0,width:"100%",borderCollapse:"separate"}},void 0,n()("tr",{},void 0,n()("td",{style:{verticalAlign:"top",width:De.avatarSize+6,minWidth:De.avatarSize+6,paddingTop:2}},void 0,this.props.icon),n()("td",{},void 0,this.renderHeader())),n()("tr",{},void 0,n()("td",{}),n()("td",{style:{maxWidth:400}},void 0,e&&this.renderChildren())),this.renderDivider())}renderDivider(){const{isLast:e}=this.props;if(!e)return n()("tr",{},void 0,n()("td",{colSpan:2},void 0,n()("div",{style:this.getBorderBottomStyle()})))}renderHeader(){const{timestamp:e,header:t,intl:i}=this.props,o=(0,ke.Yx)(Math.min(e,Date.now()),"medium_with_time",(0,Me.E2)(i),this.props.userTimeZone);return n()("div",{style:De.headerStyle},void 0,n()("div",{},void 0,t),n()("table",{style:{...this.getPathAndTimeStyle(),marginTop:4,marginBottom:this.props.children?8:4,borderSpacing:0}},void 0,n()("tr",{},void 0,n()("td",{},void 0,o),n()("td",{},void 0,this.props.navigableBlockId&&n()(Je,{getRecordValue:this.props.getRecordValue,blockId:this.props.navigableBlockId,baseUrl:this.props.baseUrl,left:n()("span",{style:this.getDotStyle()},void 0,"·"),userTimeZone:this.props.userTimeZone})))))}renderChildren(){return n()("div",{},void 0,this.props.children)}getBorderBottomStyle(){return{borderBottom:`1px solid ${this.props.theme.regularDividerColor}`,marginBottom:4}}getPathAndTimeStyle(){return{fontSize:12,color:this.theme.lightTextColor,whiteSpace:"nowrap"}}getDotStyle(){return{color:this.theme.lightTextColor,marginLeft:4,marginRight:4}}}De.avatarSize=28,De.headerStyle={fontSize:14,lineHeight:1.4};const Ne={fontWeight:I.Z.fontWeight.semibold};(0,J.injectIntl)(De);var Pe=i(70203),Ve=i(79315);function xe(e){const{edits:t,rootStore:i}=e,o=d().uniqWith(t.flatMap((e=>e.authors||[])),d().isEqual);return d().compact(o.map((e=>Ze(e,i))))}function Le(e){const{currentUserStore:t}=Ve.default.state,i=null==t?void 0:t.id;return function(e,t,i){const o=t.find((e=>e.value.id===i)),r=t.map((t=>(0,u.$4)(e,t)));if(1===t.length)return n()("span",{},void 0,n()(J.FormattedMessage,o?{defaultMessage:"You",id:"activitySection.authorPhrase.forOneAuthorCurrentUser.label",description:"Bolded string for denoting that the current user generated an activity update notification.",values:{b:e=>n()("span",{style:Ne},void 0,e)}}:{defaultMessage:"<b>{author}</b>",id:"activitySection.authorPhrase.forOneAuthor.label",description:"Bolded string for showing the single author that generated an activity update notification.",values:{author:r[0],b:e=>n()("span",{style:Ne},void 0,e)}}));if(2===t.length){if(o){const i=t.filter((e=>e!==o)).map((t=>(0,u.$4)(e,t)));return n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"<b>{firstAuthor}</b> and you",id:"activitySection.authorPhrase.forTwoAuthorsCurrentUser.label",description:"Bolded string for listing two authors in an activity update notification, with the current user being one of them.",values:{firstAuthor:i[0],b:e=>n()("span",{style:Ne},void 0,e)}}))}return n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"<b>{firstAuthor}</b> and <b>{secondAuthor}</b>",id:"activitySection.authorPhrase.forTwoAuthors.label",description:"Bolded string for listing two authors in an activity update notification.",values:{firstAuthor:r[0],secondAuthor:r[1],b:e=>n()("span",{style:Ne},void 0,e)}}))}if(r.length>2){if(o){const i=t.filter((e=>e!==o)).map((t=>(0,u.$4)(e,t))),r=n()(J.FormattedMessage,{defaultMessage:"{numberOfOtherAuthors, plural, =0 {<b>{firstAuthor}</b>, <b>{secondAuthor}</b> and you} one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, you and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, you and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthorsCurrentUser.label",description:"Bolded string for showing multiple authors that generated an activity update notification, with the current user being one of them.",values:{numberOfOtherAuthors:i.length-2,firstAuthor:i[0],secondAuthor:i[1],b:e=>n()("span",{style:Ne},void 0,e)}});return n()("span",{},void 0,r)}{const e=n()(J.FormattedMessage,{defaultMessage:"{numberOfOtherAuthors, plural, one {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} other} other {<b>{firstAuthor}</b>, <b>{secondAuthor}</b>, and {numberOfOtherAuthors} others}}",id:"activitySection.authorPhrase.forMoreThanTwoAuthors.label",description:"Bolded string for showing multiple authors that generated an activity update notification.",values:{numberOfOtherAuthors:r.length-2,firstAuthor:r[0],secondAuthor:r[1],b:e=>n()("span",{style:Ne},void 0,e)}});return n()("span",{},void 0,e)}}return n()("span",{style:Ne},void 0,n()(J.FormattedMessage,{defaultMessage:"Nobody",description:"Default text when there's an activity update with no users attached",id:"activitySection.authorPhrase.forNoAuthors.label"}))}(W.default.getIntl(),e,i)}function Ze(e,t){if(e.table===T.KJ){const i=Ke(e.id,t);if(i)return(0,u.dp)(i)}else{const i=function(e,t){return(0,Z.Kv)(t,{table:A.cZ,id:e}).getValue()}(e.id,t);if(i)return(0,u.D$)(i)}}function Ke(e,t){return Z.U6.createChildStore(t,{table:T.KJ,id:e}).getValue()}function Ue(e){const{tab:t,recordId:i,recordType:o,rootStore:r,environment:a}=e;if("all"===t){if(!i)return!1;let e;return e="block"===o?Z.G.createChildStore(r,{table:S.iU,id:i}):"collection"===o?Z.NW.createChildStore(r,{table:M.v,id:i}):Z.H2.createChildStore(r,{table:O.bx,id:i}),(0,L.yi)(a,e)}return!1}function Ee(e){const{activity:t,rootStore:i}=e;if("commented"!==t.type)return;const o=i.getRecordValue({table:_.qF,id:t.discussion_id,spaceId:t.space_id});if(!o)return;if(!o.context)return;const r=(0,Pe.VP)(o.context,(e=>!(0,Pe.xw)(e)||(0,Pe.h1)(e)===o.id));return{id:o.id,context:r}}var Fe=i(61519),qe=i(62385),Ge=i(64369);class ze extends l.Z{constructor(){super(...arguments),this.storeTypes={role:ee.default.of(void 0)}}renderComponent(){const{accessRequestStore:e}=this.props;if(e.isDefined()){if(e.isResolvedSpaceMembershipRequest())return this.renderResolvedSpaceMembershipRequest();if(this.canResolveMembershipRequests())return n()("div",{style:{display:"flex",alignItems:"center"}},void 0,n()(qe.Z,{onClick:()=>this.resolveMembershipRequest("approved"),style:this.getButtonStyle(!1)},void 0,n()(J.FormattedMessage,{defaultMessage:"Approve",id:"approveSpaceMembershipActivityAction.approveButton.label",description:"Button in notification to approve a membership request."})),n()(qe.Z,{onClick:()=>this.resolveMembershipRequest("rejected"),style:{height:26,paddingLeft:8,paddingRight:8}},void 0,n()(J.FormattedMessage,{defaultMessage:"Decline",id:"approveSpaceMembershipActivityAction.declineButton.label",description:"Decline space membership request button in notification."})),!this.environment.device.isMobile&&c.createElement(c.Fragment,null,n()(Fe.Z,{size:1,vertical:!0,style:{height:26,paddingLeft:8,paddingRight:8}}),n()(qe.Z,{onClick:()=>{D.trackClickViewAllRequests(this.environment,{disable_membership_requests:this.props.spaceStore.getDisableMembershipRequests()}),this.handleOpenSettingsMembersRequests()},style:{height:26,paddingLeft:8,paddingRight:8}},void 0,n()(J.FormattedMessage,{defaultMessage:"View all requests",id:"approveSpaceMembershipActivityAction.viewAllRequests.label",description:"Button that takes user to the settings modal members requests tab to see all existing requests."}))))}}renderResolvedSpaceMembershipRequest(){const{accessRequestStore:e}=this.props;if(!e.isDefined())return;const t=e.isResolvedSpaceMembershipRequest()&&this.renderActor(e.getResolvedByPointer());return c.createElement(c.Fragment,null,n()(Ge.Z,{isSecondaryColor:!0},void 0,"approved"===e.getStatus()?n()(J.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestApproved.title",values:{grantedBy:t},description:"Message showing that space membership request has been approved."}):n()(J.FormattedMessage,{defaultMessage:"Declined by {grantedBy}",id:"approveSpaceMembershipActivityAction.requestDeclined.title",values:{grantedBy:t},description:"Message showing that space membership request has been declined."})),n()(Ge.Z,{isSmall:!0,isSecondaryColor:!0},void 0,(0,ke.Yx)(Math.min(e.getResolvedTime(),Date.now()),"medium_with_time",(0,Me.E2)(this.props.intl))))}handleOpenSettingsMembersRequests(){_e.r({currentTab:"members",subtab:Oe.Q.Requests})}canResolveMembershipRequests(){return this.props.spaceStore.canEditMembership()}renderActor(e){const{table:t,id:i}=e;return Le(d().compact([this.getActor(t,i)]))}getActor(e,t){if(e===T.KJ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.dp)(i)}if(e===A.cZ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.D$)(i)}}get rootStore(){return this.props.accessRequestStore}async resolveMembershipRequest(e){if(!this.canResolveMembershipRequests())return;const t=this.environment,{spaceStore:i,accessRequestStore:o}=this.props;if(!o.isDefined())return;const r=this.getActor(T.KJ,o.getForActorId());r&&r.table===T.KJ&&await we.kn({environment:t,store:i,accessRequestStore:o,forActor:r.value,status:e,from:"notification"})}getButtonStyle(e){const t={height:26,paddingLeft:8,paddingRight:8,boxShadow:this.theme.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?t:{...t,color:this.theme.regularTextColor,fontWeight:500}}}ze.displayName="ApproveSpaceMembershipActivityAction";const We=(0,J.injectIntl)(ze);var He=i(13991),$e=i(27006),je=i(10279),Ye=i(9953),Xe=i(21115),Qe=i(78291),et=i(7567);class tt extends l.Z{constructor(){super(...arguments),this.storeTypes={role:ee.default.of(void 0)},this.handleApproveMembershipRequest=async()=>{},this.handleGrantPageAccess=async()=>{const{targetBlockStore:e,accessRequestStore:t}=this.props,i=this.getInviteTargetWithNewPermissionItem();if(!("permissionItem"in i))return;const o=this.environment.currentUser.id;if(!o)return;if("type"in i){let t;if("existingUser"===i.type){t=(await je.n_({environment:this.environment,store:e,inviteTargets:[i],inviteRole:i.permissionItem.role,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else if("bot"===i.type){t=(await je.n_({environment:this.environment,store:e,inviteTargets:[i],inviteRole:void 0,isOnboarding:!1,invite:{inviteOrigin:"page_request_access"}})).success}else(0,C.t1)(i);if(!t)return}V.createAndCommit({userAction:"GrantPageAccessActivityAction.handleGrantPageAccess",environment:this.environment,perform:r=>{"type"in i||je.ep({environment:this.environment,transaction:r,store:e,permissionItems:[i.permissionItem]}),Ye.sW({store:t,transaction:r,data:{granted_time:Date.now(),granted_by_table:T.KJ,granted_by_id:o,resolved_time:Date.now(),resolved_by_table:T.KJ,resolved_by_id:o,status:"approved"}})}});const r=t.getValue(),a=r&&r.created_time&&r.granted_time?r.granted_time-r.created_time:void 0;D.trackGrantAccess(this.environment,{requestId:r&&r.id,timeElapsedSinceRequest:a,newAccessLevel:i.permissionItem.role,...this.getGrantOrIgnoreAccessArgs()})},this.handleRoleChange=e=>{const t=this.props.accessRequestStore.id,i=this.stores.role.state;this.stores.role.setState(e),D.trackChangeGrantAccessLevel(this.environment,{requestId:t,previousAccessLevel:i,newAccessLevel:e,...this.getGrantOrIgnoreAccessArgs()})},this.handleArchive=()=>{const{notification:e}=this.props;e&&(V.createAndCommit({userAction:"GrantPageAccessActivityAction.handleArchive",environment:this.environment,perform:t=>{P.aZ({notification:e,rootStore:this.props.accessRequestStore,transaction:t})}}),D.trackIgnoreAccessRequest(this.environment,this.getGrantOrIgnoreAccessArgs()))}}renderComponent(){const e=this.props.accessRequestStore.getValue();if(!e)return;if((0,q.Kc)(e))return this.renderGrantedAccessRequest(e);if(!this.canGrantAccess())return;const t=e.parent_table===O.bx,i=this.getCurrentPermissionItem();if(i&&!t){const t=this.renderActor(e.for_actor_table,e.for_actor_id),o=i.role===this.getRole();return c.createElement(c.Fragment,null,n()(Ge.Z,{isSecondaryColor:!0,style:{marginBottom:6}},void 0,n()(J.FormattedMessage,{defaultMessage:"{requestingUser} already has access.",id:"grantPageAccessActivityAction.alreadyHasAccess.label",description:"Shown if the user who requested access already has access",values:{requestingUser:t}})),n()(et.Z,{upgradeButtonName:"user_permission_item",role:this.getRole(),table:S.iU,blockType:this.props.targetBlockStore.getType(),type:e.for_actor_table===T.KJ?"user_permission":"bot_permission",onChange:this.handleRoleChange,isInvite:!0,buttonStyle:this.getButtonStyle(!0)}),n()(qe.Z,{onClick:this.handleGrantPageAccess,style:this.getButtonStyle(o)},void 0,n()(J.FormattedMessage,{defaultMessage:"Change",id:"grantPageAccessActivityAction.changePermissionButton.label",description:"Change permission button for page access requests in notification."})),this.renderArchiveButton())}return c.createElement(c.Fragment,null,n()(et.Z,{upgradeButtonName:"user_permission_item",role:this.getRole(),table:S.iU,blockType:this.props.targetBlockStore.getType(),type:e.for_actor_table===T.KJ?"user_permission":"bot_permission",onChange:this.handleRoleChange,isInvite:!0,buttonStyle:this.getButtonStyle(!1)}),n()(qe.Z,{onClick:this.handleGrantPageAccess,style:this.getButtonStyle(!1)},void 0,n()(J.FormattedMessage,{defaultMessage:"Grant access",id:"grantPageAccessActivityAction.grantAccessButton.label",description:"Button in notification to grant access to a page access request."})),this.renderArchiveButton())}renderGrantedAccessRequest(e){const t=this.renderActor(e.granted_by_table,e.granted_by_id),i=(0,ke.$b)(Math.min(e.granted_time,Date.now()),He.SP,W.default.getIntl());return c.createElement(c.Fragment,null,n()(Ge.Z,{isSecondaryColor:!0},void 0,n()(J.FormattedMessage,{defaultMessage:"Approved by {grantedBy}",id:"grantPageAccessActivityAction.accessGranted.title",description:"Approval message for page access requests in notification.",values:{grantedBy:t,time:i}})),n()(Ge.Z,{isSmall:!0,isSecondaryColor:!0},void 0,i))}renderArchiveButton(){const{notification:e}=this.props;if(e&&!e.visited)return n()(qe.Z,{onClick:this.handleArchive,style:{height:26,paddingLeft:8,paddingRight:8}},void 0,n()(J.FormattedMessage,{defaultMessage:"Ignore",id:"grantPageAccessActivityAction.ignoreButton.label",description:"Ignore page access request button in notification."}))}getRole(){const e=this.getCurrentPermissionItem(),t=e&&e.role;return this.stores.role.state||t||this.props.initialRole}getNewPermissionItem(){const e=this.props.accessRequestStore.getValue();if(e)return e.for_actor_table===T.KJ?{type:"user_permission",user_id:e.for_actor_id,role:this.getRole()}:{type:"bot_permission",bot_id:e.for_actor_id,role:this.getRole()}}getInviteTargetWithNewPermissionItem(){const e=this.getNewPermissionItem();if(!e)return{};if(this.getCurrentPermissionItem())return{permissionItem:e};const{data:t}=Qe.default.state;if("user_permission"===e.type){const i=this.rootStore.getRecordValue({table:T.KJ,id:e.user_id}),o=t?Xe.CM(t):[],r=o&&o.some((t=>t.userId===e.user_id));return i&&!r?{type:"existingUser",value:i,permissionItem:e}:{permissionItem:e}}if("bot_permission"===e.type){const i=this.rootStore.getRecordValue({table:A.cZ,id:e.bot_id}),o=(t?Xe.NM(t):[]).some((t=>t.botId===e.bot_id));return i&&!o?{type:"bot",value:i,permissionItem:e}:{permissionItem:e}}(0,C.t1)(e)}getCurrentPermissionItem(){const e=this.props.accessRequestStore.getValue();if(!e)return;const t=this.props.targetBlockStore.getPermissionItems();for(const i of t){if(e.for_actor_table===T.KJ&&(0,$e.jg)(i)&&i.user_id===e.for_actor_id)return i;if(e.for_actor_table===A.cZ&&(0,$e.FB)(i)&&i.bot_id===e.for_actor_id)return i}}canGrantAccess(){return this.props.targetBlockStore.canAdmin()}renderActor(e,t){return Le(d().compact([this.getActor(e,t)]))}getActor(e,t){if(e===T.KJ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.dp)(i)}if(e===A.cZ){const i=this.rootStore.getRecordValue({table:e,id:t});if(i)return(0,u.D$)(i)}}get rootStore(){return this.props.accessRequestStore}getButtonStyle(e){const t={height:26,paddingLeft:8,paddingRight:8,boxShadow:this.theme.plainButtonBoxShadow,fontSize:12,marginRight:10};return e?t:{...t,color:this.theme.regularTextColor,fontWeight:500}}getGrantOrIgnoreAccessArgs(){const{notification:e}=this.props;return{tab:N.Jn(),activityId:null==e?void 0:e.activity_id,notificationId:null==e?void 0:e.id}}}tt.displayName="GrantPageAccessActivityAction";const it=tt;var ot=i(18698);const rt=function(e){window.__c={n:"ApproveTeamMembershipActivityButton"};const{accessRequestStore:t,teamStore:i}=e,o=(0,U.O7)(),r=(0,J.useIntl)(),{isRequestResolved:a,resolvedStatus:s,resolvedTime:d}=(0,E.VK)((()=>({isRequestResolved:t.isResolvedTeamMembershipRequest(),resolvedStatus:t.getStatus(),resolvedTime:t.getResolvedTime()})),[t]),c=(0,E.VK)((()=>{const e=t.getResolvedById();if(!e)return;const i=Z.U6.createChildStore(t,{table:T.KJ,id:e});return i?i.getDisplayName(r):void 0}),[t,r]),l=async e=>{await ot.ow({environment:o,teamStore:i,accessRequestStore:t,status:e})},h=(0,F.yK)((e=>({container:{display:"flex",alignItems:"center"},approveButton:{height:26,paddingLeft:8,paddingRight:8,fontSize:12,marginRight:10,fontWeight:500,boxShadow:e.plainButtonBoxShadow},declineButton:{height:26,paddingLeft:8,paddingRight:8}})),[]);return n()("div",{style:h.container},void 0,a?n()("div",{},void 0,n()(Ge.Z,{isSecondaryColor:!0},void 0,n()(J.FormattedMessage,"approved"===s?{defaultMessage:"Approved by {grantedBy}",id:"approveTeamMembershipActivityButton.requestApproved.title",values:{grantedBy:c},description:"Message showing that a team membership request has been approved."}:{defaultMessage:"Declined by {grantedBy}",id:"approveTeamMembershipActivityButton.requestDeclined.title",values:{grantedBy:c},description:"Message showing that a team membership request has been declined."})),n()(Ge.Z,{isSmall:!0,isSecondaryColor:!0},void 0,(0,ke.Yx)(Math.min(d,Date.now()),"medium_with_time",(0,Me.E2)(r)))):n()("div",{},void 0,n()(qe.Z,{style:h.approveButton,onClick:()=>l("approved")},void 0,n()(J.FormattedMessage,{defaultMessage:"Approve",id:"approveTeamMembershipActivityButton.approveButton.label",description:"Button in notification to approve a team membership request."})),n()(qe.Z,{style:h.declineButton,onClick:()=>l("rejected")},void 0,n()(J.FormattedMessage,{defaultMessage:"Decline",id:"approveTeamMembershipActivityButton.declineButton.label",description:"Decline team membership request button in notification."}))))};function at(e){return(0,B.SK)(e,{[p.$X]:p.tY.Notification})}function nt(e){const t=e.mightCloseTab??!0;dt({target:"body",...e,mightCloseTab:t})}function st(e){const t=e.mightCloseTab??!0;dt({target:"title",...e,mightCloseTab:t})}function dt(e){const{target:t,environment:i,activity:o,notification:r,source:a,tab:n,mightCloseTab:s}=e,d="notifications_tab"===a?K.ZP.state.sessionId:void 0,c="notifications_tab"===a?K.ZP.isFilteredToUnreadOnly():void 0;D.trackClickUpdate(i,{target:t,activity_id:o.id,notification_id:null==r?void 0:r.id,sessionId:d,is_filtered:c,tab:n}),s&&N.pw({environment:i,target:t}),r&&g.e((0,x.getClientEventTracker)(i),{alreadyRead:r.read,notificationId:r.id,activityId:r.activity_id,from:t,sessionId:d})}function ct(e){const{notification:t,activity:i,environment:o,tab:r}=e,a={environment:o,activity:i,notificationId:null==t?void 0:t.id,alreadyRead:Boolean(null==t?void 0:t.read),tab:r};return{onBacklinkClicked:e=>N.EQ({...a,backlinkPageId:e}),onArchiveClicked:()=>N._b(a),onMarkAsReadClicked:()=>N.cC(a),onMarkAsUnreadClicked:()=>N.u_(a),onNotificationFrameClicked:()=>N.ix(a)}}const lt={userSelect:"text",WebkitUserSelect:"text"},ht={padding:1,...lt},ut={display:"inline-flex",marginRight:2,verticalAlign:"text-top"},pt={fontWeight:I.Z.fontWeight.semibold};function gt(e){return{padding:0,paddingLeft:mt(e),paddingRight:16,...lt}}function mt(e){const{source:t,isMobile:i}=e;return"notifications_tab"===t?52+(i?3:2):52}function vt(e){return{height:26,paddingLeft:8,paddingRight:8,color:e.mediumTextColor}}function ft(e){return{display:"inline",whiteSpace:"normal",marginRight:e?3:0,wordBreak:"break-word",..._i.boldStyle}}function bt(e){return{boxShadow:e.plainButtonBoxShadow,height:26,paddingLeft:8,paddingRight:8,fontWeight:500,color:e.regularTextColor}}function yt(e){window.__c={n:"NotificationActions"};const{notification:t,source:i,isMobile:o,environment:r,rootStore:a,activity:s,tab:d}=e,c=Boolean(null==t?void 0:t.visited),l=(0,F.yK)((e=>({container:{paddingLeft:mt({source:i,isMobile:o})-8,paddingTop:4}})),[o,i]);return c?n()("div",{style:l.container},void 0,n()(St,{notification:t,environment:r,rootStore:a,activity:s,tab:d})):null}function St(e){window.__c={n:"UnarchiveButton"};const{notification:t,environment:i,rootStore:o,activity:r,tab:a}=e,s=(0,F.yK)((e=>({secondaryButton:vt(e)})),[]);return Boolean(null==t?void 0:t.visited)?n()(qe.Z,{onClick:()=>{t&&(V.createAndCommit({userAction:"Activity.handleUnarchive",environment:i,perform:e=>{P.E1({notificationId:t.id,visited:!1,rootStore:o,transaction:e})}}),N.F5({environment:i,activity:r,tab:a,notificationId:t.id,alreadyRead:t.read}))},style:s.secondaryButton},void 0,n()(J.FormattedMessage,{defaultMessage:"Unarchive",id:"activity.actions.unarchiveButton.label"})):null}var At=i(57688),Mt=i(62820),kt=i(84076),wt=i(31278),_t=i(76798);function Ot(e){window.__c={n:"TeamTitle"};const{teamStore:t,tabArgs:i,activity:o}=e,r=(0,U.O7)(),a=(0,E.VK)((()=>t.isDefined()),[t]),s=(0,E.VK)((()=>{var e;return null==t||null===(e=t.getModel())||void 0===e?void 0:e.getRenderIcon({getRecordModel:t.getRecordModel})}),[t]),d=(0,F.yK)((()=>({recordTitle:ft(void 0!==s)})),[s]),l=(0,c.useCallback)((()=>{nt({environment:r,activity:o,...i}),At.hI({environment:r,teamStore:t,shouldScroll:!0}),Mt.Z.setState({...Mt.Z.state,open:!1})}),[o,r,t,i]);return a?n()(kt.Z,{onClick:l,external:!1,innerStyle:ht,inline:!0},void 0,s&&c.createElement(c.Fragment,null,n()(wt.Z,{disabled:!0,icon:s,isEmptyPage:!1,size:18,style:ut})),n()(_t.Z,{store:t,style:d.recordTitle})):null}const Tt=c.memo(Ot);function Rt(e){window.__c={n:"Title"};const{titledRecordStore:t,getRecordModel:i,activity:o,tabArgs:r}=e,a=(0,E.VK)((()=>t.getModel()),[t]),s=(0,U.O7)(),d=(0,E.VK)((()=>null==a?void 0:a.getRenderIcon({getRecordModel:i})),[a,i]),l=(0,F.yK)((()=>({container:ht,icon:ut,activityTitle:{display:"inline",whiteSpace:"normal",marginRight:void 0!==d?3:0,wordBreak:"break-word",...pt}})),[d]),h=(0,E.VK)((()=>a&&at(a.getRenderUrl({getRecordModel:i}))),[a,i]);return a?n()(kt.Z,{href:h,onClick:()=>st({environment:s,activity:o,...r}),external:!1,innerStyle:l.container,inline:!0},void 0,d&&c.createElement(c.Fragment,null,n()(wt.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:18,style:l.icon}),n()("span",{},void 0," ")),n()(_t.Z,{store:t,style:l.activityTitle})):null}function Ct(e){let{activity:t,rootStore:i,tabArgs:o,isLast:a,useRedesignedIA:s}=e;const{notification:d,tab:l,source:h}=o,u=(0,c.useMemo)((()=>t.edits??[]),[t]),p=u[0],g=(0,U.O7)(),m=g.device.isMobile,v=(0,F.yK)((()=>({message:{paddingLeft:mt({source:h,isMobile:m}),paddingRight:16,marginTop:8,marginBottom:8},messageLabel:{whiteSpace:"pre-wrap"}})),[h,m]),f=Z.oK.createChildStore(i,{table:q.J8,id:t.access_request_id}),b=(0,E.VK)((()=>f.getModel()),[f]),y=(0,E.VK)((()=>(null==b?void 0:b.getParentTable())===O.bx&&!(0,z.p1)()),[b]),S=b&&n()(It,{activity:t,accessRequest:b,rootStore:i,tabArgs:o}),A=p.message,M=(0,E.VK)((()=>xe({edits:u,rootStore:i})),[u,i]),k=(0,E.VK)((()=>Le(M)),[M]);return y||!S?null:s?c.createElement(Ae,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,S),isLast:a,isPrivate:!1,rootStore:i,notification:d,icon:n()(pe,{authors:M}),showSnapshotButton:!1},ct({notification:d,activity:t,environment:g,tab:l})),A&&n()("div",{style:v.message},void 0,n()(Ge.Z,{isSmall:!0},void 0,n()(J.FormattedMessage,{id:"activity.accessRequested.messageLabel",defaultMessage:"Message from {author}",values:{author:k}})),n()(Ge.Z,{isMultiline:!0,style:v.messageLabel},void 0,A)),n()(Nt,{activity:t,accessRequestStore:f,rootStore:i,source:h,notification:d}),n()(yt,{notification:d,activity:t,source:h,tab:l,isMobile:g.device.isMobile,environment:g,rootStore:i})):c.createElement(ve,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,S),isLast:a,isPrivate:!1,rootStore:i,notification:d,icon:n()(pe,{authors:M}),showSnapshotButton:!1},ct({notification:d,activity:t,environment:g,tab:l})),A&&n()("div",{style:v.message},void 0,n()(Ge.Z,{isSmall:!0},void 0,n()(J.FormattedMessage,{id:"activity.accessRequested.messageLabel",defaultMessage:"Message from {author}",values:{author:k}})),n()(Ge.Z,{isMultiline:!0,style:v.messageLabel},void 0,A)),n()(Nt,{activity:t,accessRequestStore:f,rootStore:i,source:h,notification:d}),n()(yt,{notification:d,activity:t,source:h,tab:l,isMobile:g.device.isMobile,environment:g,rootStore:i}))}function It(e){const{activity:t,accessRequest:i,rootStore:o,tabArgs:r}=e,a=(0,E.VK)((()=>i.getParentTable()),[i]);switch(a){case O.bx:return n()(Jt,{activity:t,accessRequest:i,rootStore:o});case G.e0:return n()(Dt,{activity:t,rootStore:o,tabArgs:r});case S.iU:return n()(Bt,{activity:t,tabArgs:r,rootStore:o});default:(0,C.t1)(a)}}function Bt(e){window.__c={n:"BlockAccessRequestHeader"};const{activity:t,rootStore:i,tabArgs:o}=e,r=(0,c.useMemo)((()=>t.edits??[]),[t]),a=(0,E.VK)((()=>xe({edits:r,rootStore:i})),[r,i]),s=(0,E.VK)((()=>Le(a)),[a]);if(!t.navigable_block_id)return null;const d=Z.G.createChildStore(i,{table:S.iU,id:t.navigable_block_id});return n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested access to {pageName}} other {{authorOrAuthors} requested access to {pageName}}}",values:{numberOfAuthors:a.length,authorOrAuthors:s,pageName:n()(Rt,{titledRecordStore:d,activity:t,tabArgs:o,getRecordModel:i.getRecordModel})},id:"activity.accessRequested.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}function Jt(e){const{activity:t,accessRequest:i,rootStore:o}=e,r=(0,c.useMemo)((()=>t.edits??[]),[t]),a=(0,F.yK)((()=>({inviteePhrase:{fontWeight:I.Z.fontWeight.semibold}})),[]),s=(0,E.VK)((()=>i.getForActorPointer()),[i]),d=Z.U6.createChildStore(o,{table:T.KJ,id:s.id}),l=(0,E.VK)((()=>d.getModel()),[d]),h=(0,E.VK)((()=>null==l?void 0:l.getEmail()),[l]),u=(0,E.VK)((()=>i.getForActorId()===i.getCreatedById()),[i]),p=(0,E.VK)((()=>xe({edits:r,rootStore:o})),[r,o]),g=(0,E.VK)((()=>Le(p)),[p]),m=(0,E.VK)((()=>{if(!u)return h;const e=null==l?void 0:l.getFullName(W.default.getIntl());return e?`${e} (${h})`:h}),[u,l,h]);return l&&s.table===T.KJ?n()(J.FormattedMessage,u?{defaultMessage:"{invitee} requested to become a workspace member",values:{invitee:n()("span",{style:a.inviteePhrase},void 0,m)},id:"activity.accessRequestedMembershipFromGuest.header",description:"Notification header describing that a user created a membership request for themself."}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} requested {invitee} to become a workspace member} other {{authorOrAuthors} requested {invitee} to become a workspace member}}",values:{numberOfAuthors:p.length,authorOrAuthors:g,invitee:n()("span",{style:a.inviteePhrase},void 0,m)},id:"activity.accessRequestedMembership.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):null}function Dt(e){window.__c={n:"TeamMembershipRequestHeader"};const{activity:t,rootStore:i,tabArgs:o}=e,r=(0,c.useMemo)((()=>t.edits??[]),[t]),a=(0,E.VK)((()=>xe({edits:r,rootStore:i})),[r,i]),s=(0,E.VK)((()=>Le(a)),[a]);if(!r||!t.team_id)return null;const d=Z.zX.createChildStore(i,{table:G.e0,id:t.team_id});return n()(J.FormattedMessage,{defaultMessage:"{user} requested to become a member of {teamName}",values:{user:n()("span",{style:{fontWeight:I.Z.fontWeight.semibold}},void 0,s),teamName:n()(Tt,{teamStore:d,activity:t,tabArgs:o})},id:"activity.teamAccessRequest.header",description:"Notification header describing that a user created a team access request."})}function Nt(e){const{activity:t,accessRequestStore:i,rootStore:o,source:r,notification:a}=e,s=(0,c.useMemo)((()=>t.edits||[]),[t])[0],d=(0,E.VK)((()=>i.getParentTable()),[i]),l=(0,E.VK)((()=>i.getParentId()),[i]),h=(0,U.O7)().device.isMobile,u=(0,F.yK)((e=>({actionPrimaryContainer:{paddingLeft:mt({source:r,isMobile:h}),paddingTop:12,paddingBottom:8},actionButton:bt(e)})),[r,h]),p=l?Z.G.createChildStore(o,{table:S.iU,id:l}):void 0,g=(0,E.VK)((()=>d===S.iU&&Boolean(null==p?void 0:p.canAdmin())),[d,p]);if(!d||!l||!s)return null;switch(d){case S.iU:return g&&p?n()("div",{style:u.actionPrimaryContainer},void 0,n()(it,{accessRequestStore:i,targetBlockStore:p,initialRole:"reader",buttonStyle:u.actionButton,notification:a})):null;case O.bx:const e=Z.H2.createChildStore(o,{table:d,id:l});return n()("div",{style:u.actionPrimaryContainer},void 0,n()(We,{accessRequestStore:i,spaceStore:e,initialRole:"reader",buttonStyle:u.actionButton,notification:a}));case G.e0:const t=Z.zX.createChildStore(o,{table:d,id:l});return n()("div",{style:u.actionPrimaryContainer},void 0,n()(rt,{accessRequestStore:i,teamStore:t}));default:(0,C.t1)(d)}}const Pt=c.memo(Ct);var Vt=i(79931),xt=i(64921);class Lt extends l.Z{constructor(){super(...arguments),this.storeTypes={open:ee.default.of(!1)},this.handleOpen=()=>{this.stores.open.set(!0)}}renderComponent(){return this.stores.open.get()||this.props.items.length<=this.props.visible?n()("div",{},void 0,this.props.items):n()("div",{},void 0,this.props.items.slice(0,this.props.visible),n()(xt.Z,{onClick:this.handleOpen,style:this.getStyle()},void 0,n()(J.FormattedMessage,{defaultMessage:"View {moreCount} more",id:"activity.viewMoreButton.label",values:{moreCount:this.props.items.length-this.props.visible}})))}getStyle(){return{display:"flex",alignItems:"center",height:28,fontSize:12,color:this.theme.lightTextColor,padding:0,paddingLeft:52,paddingRight:16}}}Lt.displayName="ViewMore";const Zt=Lt;function Kt(e){const{activity:t,rootStore:i,tabArgs:o,isLast:a,isTopbarUpdatesMenu:s,useRedesignedIA:d}=e,{tab:l,notification:h,source:u}=o,p=(0,R.hI)(t.edits??[]),g=p.length>0,m=Z.G.createChildStore(i,{table:S.iU,id:p[0].navigable_block_id}),v=(0,E.VK)((()=>xe({edits:p,rootStore:i})),[p,i]),f=(0,E.VK)((()=>Le(v)),[v]),b=(0,U.O7)(),y=(0,E.VK)((()=>Ue({recordId:m.id,recordType:"block",tab:l,rootStore:i,environment:b})),[m,l,i,b]);if(!(0,E.VK)((()=>m.isDefined()),[m])||!g)return null;const A=n()(Rt,{titledRecordStore:m,getRecordModel:i.getRecordModel,activity:t,tabArgs:o});return d?c.createElement(Ae,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated {pageTitle}} other {{authorOrAuthors} updated {pageTitle}}}",id:"activity.blockEdited.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:v.length,authorOrAuthors:f,pageTitle:A}})),isLast:a,isPrivate:y,rootStore:i,navigableBlockId:m.id,notification:h,icon:n()(pe,{authors:v}),showSnapshotButton:s},ct({notification:h,activity:t,environment:b,tab:l})),n()(Zt,{visible:5,items:p.map(((e,r)=>n()(Ut,{edit:e,rootStore:i,onClick:()=>nt({environment:b,activity:t,...o}),source:u,isMobile:b.device.isMobile},r)))}),n()(yt,{notification:h,activity:t,source:u,tab:l,isMobile:b.device.isMobile,environment:b,rootStore:i})):c.createElement(ve,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:v.length,authorOrAuthors:f,pageTitle:A}})),isLast:a,isPrivate:y,rootStore:i,navigableBlockId:m.id,notification:h,icon:n()(pe,{authors:v}),showSnapshotButton:s},ct({notification:h,activity:t,environment:b,tab:l})),n()(Zt,{visible:5,items:p.map(((e,r)=>n()(Ut,{edit:e,rootStore:i,onClick:()=>nt({environment:b,activity:t,...o}),source:u,isMobile:b.device.isMobile},r)))}),n()(yt,{notification:h,activity:t,source:u,tab:l,isMobile:b.device.isMobile,environment:b,rootStore:i}))}function Ut(e){window.__c={n:"BlockPropertyEditComponent"};const{rootStore:t,edit:i,onClick:o,source:r,isMobile:a}=e,s=(0,E.VK)((()=>function(e,t){const i=t.getRecordModel({table:S.iU,id:e.block_id}),o=(null==i?void 0:i.getType())===m.Ti.tableRow?t.getRecordModel({table:S.iU,id:i.getParentId()}):i;return null==o?void 0:o.getRenderUrl({getRecordModel:t.getRecordModel})}(i,t)||y._j.root),[i,t]);return n()(kt.Z,{href:s,onClick:o,innerStyle:gt({source:r,isMobile:a})},void 0,n()(Vt.Z,{edit:i,rootStore:t}))}var Et=i(98459),Ft=i(4083),qt=i(14976),Gt=i(17731),zt=i(98165);function Wt(e){let{activity:t,tabArgs:i,rootStore:o,isLast:a,useRedesignedIA:s}=e;const d=t.edits??[],{source:l,tab:h,notification:u}=i;let p=d.filter((e=>{switch(e.type){case"comment-changed":return!1;case"comment-created":case"comment-deleted":return!0;default:(0,C.t1)(e)}}));0===p.length&&0!==d.length&&"updates_sidebar"!==l&&(p=d);const g=p.length>0,m=(0,U.O7)(),v=o.getRecordStore(o,{table:_.qF,id:t.discussion_id,spaceId:t.space_id}),f=(0,E.VK)((()=>v.isDefined()),[v]),b=(0,E.VK)((()=>{const e=v.getParentPointer();if(e)return Z.G.createChildStore(o,e)}),[v,o]),y=(0,E.VK)((()=>Boolean(b&&b.isDefined())),[b]),A=Z.G.createChildStore(o,{table:S.iU,id:t.navigable_block_id}),M=(0,E.VK)((()=>A.isDefined()),[A]),k=(0,E.VK)((()=>Boolean(b&&(0,zt.fl)((0,zt.qA)(b)))),[b]),w=(0,E.VK)((()=>{if(!k||!b)return;const e=b.getModel();return e?at(e.getRenderUrl({getRecordModel:o.getRecordModel,discussionId:t.discussion_id})):void 0}),[k,b,o,t.discussion_id]),O=(0,E.VK)((()=>xe({edits:p,rootStore:o})),[p,o]),T=(0,E.VK)((()=>Le(O)),[O]),R=k,I=(0,c.useCallback)((e=>{if(nt({...i,environment:m,activity:t,mightCloseTab:R}),!k&&b){var o;const r=e.target;Ft.oK({environment:m,discussionStore:v,rect:r.getBoundingClientRect(),blockStore:b,discussionLocation:Yt({forReplyMenu:!0,source:i.source}),activityId:t.id,notificationId:null===(o=i.notification)||void 0===o?void 0:o.id})}}),[t,k,b,v,m,i,R]),B=(0,c.useCallback)((()=>{var e;e={...i,environment:m,activity:t,mightCloseTab:R},dt({target:"add_reaction",...e,mightCloseTab:!1})}),[i,m,t,R]),D=n()(Rt,{titledRecordStore:A,getRecordModel:o.getRecordModel,activity:t,tabArgs:i}),N=(0,E.VK)((()=>Ue({recordId:t.navigable_block_id,recordType:S.iU,tab:h,rootStore:o,environment:m})),[t,h,o,m]),P=m.device.isMobile,V=(0,E.VK)((()=>Yt({source:l,forReplyMenu:!1})),[l]);return g&&M&&y&&f?s?c.createElement(Ae,r()({timestamp:parseInt(t.end_time),header:T,isLast:a,isPrivate:N,rootStore:o,prominentTitleLink:D,navigableBlockId:t.navigable_block_id,notification:u,icon:n()(pe,{authors:O}),showSnapshotButton:!1},ct({notification:u,environment:m,tab:h,activity:t})),n()(Ht,{activity:t,url:w,onClick:I,rootStore:o,source:l}),n()(Zt,{visible:5,items:p.map(((e,t,i)=>n()(kt.Z,{onClick:I,href:w,innerStyle:gt({source:l,isMobile:P})},t,n()(Vt.Z,{edit:e,rootStore:o,type:"comment-edit",discussionLocation:V,onReactionClick:B}))))}),n()($t,{activity:t,rootStore:o,source:l,tab:h,notification:u})):c.createElement(ve,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} commented in {blockName}} other {{authorOrAuthors} commented in {blockName}}}",values:{numberOfAuthors:O.length,authorOrAuthors:T,blockName:D},id:"activity.commentActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:a,isPrivate:N,rootStore:o,navigableBlockId:t.navigable_block_id,notification:u,icon:n()(pe,{authors:O}),showSnapshotButton:!1},ct({notification:u,environment:m,tab:h,activity:t})),n()(Ht,{activity:t,url:w,onClick:I,rootStore:o,source:l}),n()(Zt,{visible:5,items:p.map(((e,t,i)=>n()(kt.Z,{onClick:I,href:w,innerStyle:gt({source:l,isMobile:P})},t,n()(Vt.Z,{edit:e,rootStore:o,type:"comment-edit",discussionLocation:V,onReactionClick:B}))))}),n()($t,{activity:t,rootStore:o,source:l,tab:h,notification:u})):null}function Ht(e){window.__c={n:"CommentContext"};const{url:t,onClick:i,activity:o,rootStore:r,source:a}=e,s=(0,E.VK)((()=>Ee({activity:o,rootStore:r})),[o,r]),d=null==s?void 0:s.id,c=null==s?void 0:s.context,l=0===(0,Pe.ll)(c).length,h=(0,U.O7)(),u=h.device.isMobile,p=(0,F.Fg)(),g=(0,F.yK)((e=>({linkbox:{...gt({source:a,isMobile:u}),display:"flex",alignItems:"flex-start",fontSize:14,...l&&{color:e.mediumTextColor},paddingTop:2,paddingBottom:6,marginBottom:0},blockContext:{flexShrink:0,alignSelf:"center",width:3,borderRadius:3,marginLeft:2,marginRight:8,height:20,background:H.DB}})),[l,u,a]),m=(0,E.VK)((()=>(0,qt.IY)({environment:h,textValue:c?{value:c,spaceId:o.space_id}:void 0,parentStore:r,disableHover:!0,disableStyleAnnotations:!1,disableDateStyleAnnotations:!1,disabled:!0,highlightDiscussionId:d,theme:p,emojiType:(0,Gt.e_)(h),katex:h.KatexStore.getKatex(),formulaValueTypes:[]})),[r,h,c,d,p,o.space_id]);return s?n()(kt.Z,{href:t,onClick:i,innerStyle:g.linkbox},void 0,l&&n()("div",{style:g.blockContext}),n()("div",{style:I.Z.textOverflowStyle},void 0,m)):null}function $t(e){window.__c={n:"CommentActions"};const{activity:t,rootStore:i,source:o,notification:r,tab:a}=e,s=i.getRecordStore(i,{table:_.qF,id:t.discussion_id,spaceId:t.space_id}),d=(0,E.VK)((()=>s.isDefined()),[s]),l=(0,U.O7)(),h=l.device.isMobile,u=Z.t1.createChildStore(i,{table:_.qF,id:t.discussion_id,spaceId:(0,Et.CG)(i.pointer.spaceId)}),p=(0,E.VK)((()=>s.getParentId()),[s]),g=(0,c.useCallback)((e=>{if(!p)return;const n=Z.G.createChildStore(i,{table:S.iU,id:p}),s=e.target,d=null==r?void 0:r.id;Ft.oK({environment:l,discussionStore:u,rect:s.getBoundingClientRect(),blockStore:n,discussionLocation:Yt({forReplyMenu:!0,source:o}),activityId:t.id,notificationId:d}),"notifications_tab"===o&&N.gY({environment:l,notificationId:d,alreadyRead:Boolean(null==r?void 0:r.read),activity:t,tab:a})}),[t,u,l,r,p,i,o,a]),m=(0,F.yK)((e=>({container:{paddingLeft:mt({source:o,isMobile:h}),paddingTop:12,paddingBottom:4},actionButton:bt(e)})),[h,o]),v=Boolean(null==r?void 0:r.visited);return d?n()("div",{style:m.container},void 0,n()(qe.Z,{onClick:g,style:m.actionButton},void 0,n()(J.FormattedMessage,{defaultMessage:"Reply",id:"activity.replyButton.label"})),v&&c.createElement(c.Fragment,null,n()(jt,{}),n()(St,{notification:r,environment:l,rootStore:i,activity:t,tab:a}))):null}function jt(){return window.__c={n:"Separator"},n()("div",{style:{width:5,display:"inline-block"}})}function Yt(e){const{forReplyMenu:t,source:i}=e;if("updates_sidebar"===i)return t?"reply_menu_updates_sidebar":"updates_sidebar";return`${t?"reply_menu_":"updates_menu_"}${N.Jn()}`}const Xt=c.memo(Wt);const Qt=function(e){window.__c={n:"EmailEditedActivity"};const{activity:t,rootStore:i,tabArgs:o,isLast:a,isTopbarUpdatesMenu:s,useRedesignedIA:d}=e,{tab:l,notification:h}=o,u=(0,U.O7)(),p=(0,R.hI)(t.edits??[]),g=(0,E.VK)((()=>xe({edits:p,rootStore:i})),[p,i]),m=(0,E.VK)((()=>Le(g)),[g]),{oldEmail:v,newEmail:f}=(0,E.VK)((()=>{const e=p[0];return{oldEmail:e?e.old_email:"",newEmail:e?e.new_email:""}}),[p]);return d?c.createElement(Ae,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} changed email from {oldEmail} to {newEmail}} other {{authorOrAuthors} changed email from {oldEmail} to {newEmail}}}",values:{numberOfAuthors:g.length,authorOrAuthors:m,oldEmail:v,newEmail:f},id:"activity.emailEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:a,isPrivate:!1,rootStore:i,notification:h,icon:n()(pe,{authors:g}),showSnapshotButton:s},ct({notification:h,activity:t,environment:u,tab:l}))):c.createElement(ve,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} changed email from {oldEmail} to {newEmail}} other {{authorOrAuthors} changed email from {oldEmail} to {newEmail}}}",values:{numberOfAuthors:g.length,authorOrAuthors:m,oldEmail:v,newEmail:f},id:"activity.emailEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:a,isPrivate:!1,rootStore:i,notification:h,icon:n()(pe,{authors:g}),showSnapshotButton:s},ct({notification:h,activity:t,environment:u,tab:l})))};var ei=i(54584);function ti(e){const{activity:t,rootStore:i,isLast:o,tabArgs:a,useRedesignedIA:s}=e,{tab:d,notification:l,source:h}=a,u=(0,U.O7)(),p=t.edits??[],g=p.length>0,m=p[0],v=Z.G.createChildStore(i,{table:S.iU,id:m.navigable_block_id}),f=(0,E.VK)((()=>v.isDefined()),[v]),b=Z.G.createChildStore(i,{table:S.iU,id:t.mentioned_block_id}),y=(0,E.VK)((()=>b.isDefined()),[b]),A=(0,E.VK)((()=>{const e=b.getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:i.getRecordModel})}),[b,i]),M=(0,E.VK)((()=>i.getModel()),[i]),k=(0,E.VK)((()=>(0,ei.QH)(W.default.getIntl(),M,t.mentioned_group_id)),[M,t]),w=(0,E.VK)((()=>xe({edits:t.edits||[],rootStore:i})),[t,i]),_=(0,E.VK)((()=>Le(w)),[w]),O=u.device.isMobile,T=(0,E.VK)((()=>Ue({recordId:v.id,recordType:S.iU,tab:d,rootStore:i,environment:u})),[v,d,i,u]);if(!(g&&f&&y&&A))return null;const R=n()(Rt,{titledRecordStore:v,activity:t,tabArgs:a,getRecordModel:i.getRecordModel});return s?c.createElement(Ae,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{authorOrAuthors} mentioned {groupName} in a page",values:{authorOrAuthors:_,groupName:k},id:"activity.groupMentionActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:o,isPrivate:T,rootStore:i,prominentTitleLink:R,navigableBlockId:v.id,notification:l,icon:n()(pe,{authors:w}),showSnapshotButton:!1},ct({notification:l,activity:t,environment:u,tab:d})),n()(kt.Z,{href:A,onClick:()=>nt({environment:u,activity:t,...a}),innerStyle:gt({source:h,isMobile:O})},void 0,n()(Vt.Z,{edit:m,rootStore:i})),n()(yt,{notification:l,activity:t,source:h,tab:d,isMobile:O,environment:u,rootStore:i})):c.createElement(ve,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{authorOrAuthors} mentioned {groupName} in {pageName}",values:{authorOrAuthors:_,pageName:R,groupName:k},id:"activity.groupMentionActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:o,isPrivate:T,rootStore:i,navigableBlockId:v.id,notification:l,icon:n()(pe,{authors:w}),showSnapshotButton:!1},ct({notification:l,activity:t,environment:u,tab:d})),n()(kt.Z,{href:A,onClick:()=>nt({environment:u,activity:t,...a}),innerStyle:gt({source:h,isMobile:O})},void 0,n()(Vt.Z,{edit:m,rootStore:i})),n()(yt,{notification:l,activity:t,source:h,tab:d,isMobile:O,environment:u,rootStore:i}))}function ii(e){let t,i,{permissionGroup:o,spaceId:r}=e;window.__c={n:"PermissionGroupTitle"},o?(t=o.icon,i=o.name||n()(J.FormattedMessage,{defaultMessage:"Untitled group",id:"activity.permissionGroupTitles.untitledGroup"})):i=n()(J.FormattedMessage,{defaultMessage:"Deleted group",id:"activity.permissionGroupTitles.deletedGroup"});const a=void 0!==t,s=(0,F.yK)((()=>({title:ft(a)})),[a]),d=(0,c.useMemo)((()=>(0,C.$K)(t)?{icon:t,pointer:{table:"space",id:r}}:void 0),[t,r]);return n()("span",{},void 0,d&&n()(wt.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:18,style:ut}),n()("span",{style:s.title},void 0,i))}const oi=c.memo(ii);const ri=function(e){window.__c={n:"PrivateContentTransferredActivity"};const{activity:t,rootStore:i,tabArgs:o,isLast:a,useRedesignedIA:s}=e,{tab:d,notification:l}=o,h=(0,U.O7)(),p=(0,c.useMemo)((()=>t.edits??[]),[t]),g=(0,E.VK)((()=>xe({edits:p,rootStore:i})),[p,i]),m=(0,E.VK)((()=>Le(g)),[g]),v=Z.G.createChildStore(i,{table:S.iU,id:t.navigable_block_id}),f=(0,E.VK)((()=>v.isDefined()),[v]),b=(0,E.VK)((()=>Ue({recordId:v.id,recordType:S.iU,tab:d,rootStore:i,environment:h})),[v,d,i,h]),y=p[0],A=(0,E.VK)((()=>Ke(y.from_user_id,i)),[y,i]),M=(0,E.VK)((()=>Ke(y.to_user_id,i)),[y,i]);if(!(p.length>0&&A&&M&&f))return null;const k=(0,u.$4)(W.default.getIntl(),{table:T.KJ,value:A}),w=n()(Rt,{titledRecordStore:v,activity:t,tabArgs:o,getRecordModel:i.getRecordModel});return s?c.createElement(Ae,r()({timestamp:parseInt(t.end_time),header:n()(J.FormattedMessage,{defaultMessage:"{authorPhrase} transferred private content from {fromUserName} to you",values:{authorPhrase:m,fromUserName:k},id:"activity.privateContentTransferred.standardizedHeader",description:"Notification header for when private content is transferred from one user to another."}),isLast:a,prominentTitleLink:w,isPrivate:b,rootStore:i,notification:o.notification,icon:n()(pe,{authors:g}),showSnapshotButton:!1},ct({notification:l,activity:t,environment:h,tab:d}))):c.createElement(ve,r()({timestamp:parseInt(t.end_time),header:n()(J.FormattedMessage,{defaultMessage:"{authorPhrase} transferred private content from {fromUserName} to you: {pageName}",values:{authorPhrase:m,fromUserName:k,pageName:w},id:"activity.privateContentTransferred.header",description:"Notification header for when private content is transferred from one user to another."}),isLast:a,isPrivate:b,rootStore:i,notification:o.notification,icon:n()(pe,{authors:g}),showSnapshotButton:!1},ct({notification:l,activity:t,environment:h,tab:d})))};function ai(e){const{activity:t,rootStore:i,tabArgs:o,isLast:a,useRedesignedIA:s}=e,{notification:d,tab:l,source:h}=o,u=(0,U.O7)(),p=t.edits??[],g=p.length>0,m=Z.G.createChildStore(i,{table:S.iU,id:p[0].navigable_block_id}),v=(0,E.VK)((()=>m.isDefined()),[m]),f=Z.G.createChildStore(i,{table:S.iU,id:t.reminder_block_id}),b=(0,E.VK)((()=>f.isDefined()),[f]),y=(0,E.VK)((()=>{const e=f.getModel();if(e)return e.getRenderUrl({getRecordModel:i.getRecordModel})}),[f,i]),A=(0,E.VK)((()=>Ue({recordId:m.id,recordType:S.iU,tab:l,rootStore:i,environment:u})),[m,l,i,u]);if(!(g&&v&&b&&y))return null;const M=u.device.isMobile,k=at(y),w=n()(Rt,{titledRecordStore:m,getRecordModel:i.getRecordModel,activity:t,tabArgs:o});return s?c.createElement(Ae,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"Reminder in {pageTitle}",id:"activity.reminderInActivity.header",values:{pageTitle:w}})),isLast:a,isPrivate:A,rootStore:i,navigableBlockId:m.id,notification:d,icon:n()(ge,{}),showSnapshotButton:!1},ct({notification:d,activity:t,environment:u,tab:l})),n()(kt.Z,{href:k,onClick:()=>nt({environment:u,activity:t,...o}),innerStyle:gt({source:h,isMobile:M})},void 0,n()(Vt.Z,{edit:p[0],rootStore:i}))):c.createElement(ve,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"Reminder in {pageTitle}",id:"activity.reminderInActivity.header",values:{pageTitle:w}})),isLast:a,isPrivate:A,rootStore:i,navigableBlockId:m.id,notification:d,icon:n()(ge,{}),showSnapshotButton:!1},ct({notification:d,activity:t,environment:u,tab:l})),n()(kt.Z,{href:k,onClick:()=>nt({environment:u,activity:t,...o}),innerStyle:gt({source:h,isMobile:M})},void 0,n()(Vt.Z,{edit:p[0],rootStore:i})))}function ni(e){const{activity:t,rootStore:i,tabArgs:o,isLast:a,useRedesignedIA:s}=e,{notification:d,tab:l}=o,h=(0,U.O7)(),u=t.edits??[],p=u.length>0,g=(0,E.VK)((()=>xe({edits:t.edits||[],rootStore:i})),[t,i]),m=(0,E.VK)((()=>Le(g)),[g]),v=u[0],f=Z.zX.createChildStore(i,{table:G.e0,id:v.team_id}),b=(0,E.VK)((()=>f.isDefined()),[f]);return p&&b?s?c.createElement(Ae,r()({timestamp:parseInt(t.end_time),header:n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a teamspace} other {{authorOrAuthors} invited you to a teamspace}}",values:{numberOfAuthors:g.length,authorOrAuthors:m},id:"activity.userInvitedToTeamActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),prominentTitleLink:n()(Tt,{teamStore:f,activity:t,tabArgs:o}),isLast:a,isPrivate:!1,rootStore:i,notification:d,icon:n()(pe,{authors:g}),showSnapshotButton:!1},ct({notification:d,activity:t,environment:h,tab:l}))):c.createElement(ve,r()({timestamp:parseInt(t.end_time),header:n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to teamspace {teamName}} other {{authorOrAuthors} invited you to {teamName}}}",values:{numberOfAuthors:g.length,authorOrAuthors:m,teamName:n()(Tt,{teamStore:f,activity:t,tabArgs:o})},id:"activity.userInvitedToTeamActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),isLast:a,isPrivate:!1,rootStore:i,notification:d,icon:n()(pe,{authors:g}),showSnapshotButton:!1},ct({notification:d,activity:t,environment:h,tab:l}))):null}var si=i(84683),di=i(94044),ci=i(63143),li=i(45094);function hi(e){window.__c={n:"TitleCard"};const{titledRecordStore:t,getRecordModel:i,activity:o,tabArgs:r}=e,a=(0,E.VK)((()=>t.getModel()),[t]),s=(0,U.O7)(),d=(0,E.VK)((()=>null==a?void 0:a.getRenderIcon({getRecordModel:i})),[a,i]),c=(0,F.yK)((e=>({container:{...ht,display:"block",border:`1px solid ${e.outlineButtonBorder}`,borderRadius:3,marginTop:8,padding:10},icon:{...ut,marginRight:8},activityTitle:{display:"inline",whiteSpace:"normal",marginRight:void 0!==d?3:0,wordBreak:"break-word",...pt},flexRow:{display:"flex",alignItems:"center"},spacer:{flexGrow:1},subtitle:{fontSize:12,color:e.lightTextColor},avatarContainer:{display:"flex",flexDirection:"row",justifyContent:"start",overflow:"hidden",paddingRight:10},avatar:{marginRight:-5,position:"relative"}})),[d]),l=(0,E.VK)((()=>a&&at(a.getRenderUrl({getRecordModel:i}))),[a,i]),h=(0,E.VK)((()=>{const e=t.table;switch(e){case"space":const i=t.getPublicSpaceData();return i?n()("div",{},void 0,n()(J.FormattedMessage,{id:"activity.titleCard.spaceSubtitle",description:"Label for the space card in the user-invited notification indicating number of workspace members and workspace plan type.",defaultMessage:"{numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}} · {planType}",values:{numberOfWorkspaceMembers:W.default.formatNumber(i.memberCount),planType:W.default.formatMessage((0,li.em)(i.subscriptionTier))}})):null;case"block":const o=(0,zt.u3)(t);return o?n()(_t.Z,{store:o}):null;default:(0,C.t1)(e)}}),[t]),u=(0,E.VK)((()=>{if(!a)return[];const e=a.table;let i=[];switch(e){case"space":i=a.getUserPermissionItems().slice(0,4).map((e=>e.user_id));break;case"block":const t=a.getCreatedByPointer();(null==t?void 0:t.table)===T.KJ&&(i=[t.id]);break;default:(0,C.t1)(e)}return n()("div",{style:c.avatarContainer},void 0,i.map((e=>{const i=Z.U6.createChildStore(t,{table:T.KJ,id:e});if(i)return n()(ae.Z,{userStore:i,size:24,avatarShouldShowShadow:!1,style:c.avatar,isOffline:!1,hasTooltip:!s.device.isMobile})})))}),[s.device.isMobile,a,c,t]);return a?n()(kt.Z,{href:l,onClick:()=>st({environment:s,activity:o,...r}),external:!1,innerStyle:c.container,inline:!0},void 0,n()("div",{style:c.flexRow},void 0,d&&n()(wt.Z,{disabled:!0,icon:d,isEmptyPage:!1,size:25,style:c.icon}),n()("div",{},void 0,n()(_t.Z,{store:t,style:c.activityTitle}),n()("div",{style:c.subtitle},void 0,h)),n()("div",{style:c.spacer}),n()("div",{},void 0,u))):null}function ui(e){const{activity:t,rootStore:i,tabArgs:o,isLast:a,useRedesignedIA:s}=e,{notification:d,tab:l}=o,h=(0,U.O7)(),p=(t.edits??[])[0],g=fi({rootStore:i,edit:p}),m=function(e){let{data:t,spaceId:i,tab:o,rootStore:r}=e;const a=(0,U.O7)();return(0,E.VK)((()=>{let e,n;if(!t)return!1;if("block"===(null==t?void 0:t.type))e=t.block.id,n="block";else if("space"===(null==t?void 0:t.type)||"group"===(null==t?void 0:t.type)){if(!i)return!1;e=i,n="space"}else(0,C.t1)(t);return Ue({recordId:e,recordType:n,tab:o,rootStore:r,environment:a})}),[t,a,r,i,o])}({data:g,spaceId:p.space_id,tab:l,rootStore:i}),v=(0,E.VK)((()=>xe({edits:t.edits??[],rootStore:i})),[t.edits,i]),f=(0,c.useMemo)((()=>ct({notification:d,environment:h,tab:l,activity:t})),[t,h,d,l]);if(!t.edits||0===t.edits.length||!g)return null;const b=parseInt(t.end_time),y=0===v.filter(u.uC).length,S=y?void 0:n()(pe,{authors:v});return s?c.createElement(Ae,r()({timestamp:b,header:n()("span",{},void 0,n()(gi,{data:g,authors:v,isFromBot:y,spaceId:p.space_id})),prominentTitleLink:n()(pi,{data:g,activity:t,tabArgs:o,getRecordModel:i.getRecordModel}),isLast:a,isPrivate:m,rootStore:i,navigableBlockId:t.navigable_block_id,notification:d,icon:S,showSnapshotButton:!1},f),c.createElement(vi,r()({},e,{edit:p}))):c.createElement(ve,r()({timestamp:b,header:n()("span",{},void 0,n()(mi,{data:g,authors:v,isFromBot:y,activity:t,tabArgs:o,getRecordModel:i.getRecordModel,spaceId:p.space_id})),isLast:a,isPrivate:m,rootStore:i,navigableBlockId:t.navigable_block_id,notification:d,icon:S,showSnapshotButton:!1},f),c.createElement(vi,r()({},e,{edit:p})))}function pi(e){let{data:t,activity:i,tabArgs:o,getRecordModel:r}=e;switch(t.type){case"block":return n()(hi,{tabArgs:o,titledRecordStore:t.block,activity:i,getRecordModel:r});case"group":return null;case"space":return n()(hi,{tabArgs:o,titledRecordStore:t.space,activity:i,getRecordModel:r});default:(0,C.t1)(t)}}function gi(e){let{data:t,authors:i,isFromBot:o,spaceId:r}=e;const a=(0,E.VK)((()=>Le(i)),[i]);switch(t.type){case"block":return n()(J.FormattedMessage,o?{defaultMessage:"You have been invited to a page",id:"activity.userInvitedActivityNavigableBlockByBot.standardizedHeader",description:"Notification header for updates. Used when the invite is from a bot."}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a page} other {{authorOrAuthors} invited you to a page}}",values:{numberOfAuthors:i.length,authorOrAuthors:a},id:"activity.userInvitedActivityNavigableBlock.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case"group":const e=n()(oi,{permissionGroup:t.group,spaceId:r});return n()(J.FormattedMessage,o?{defaultMessage:"You have been invited to group {groupName}",values:{groupName:e},id:"activity.userInvitedActivityGroupIdByBot.standardizedHeader",description:"Notification header for updates. Used when the invite is from a bot."}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to group {groupName}} other {{authorOrAuthors} invited you to group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:a,groupName:e},id:"activity.userInvitedActivityGroupId.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case"space":return n()(J.FormattedMessage,o?{defaultMessage:"You have been invited to a workspace",id:"activity.userInvitedActivityOtherInviteByBot.standardizedHeader",description:"Notification header for updates. Used when the invite is from a bot."}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to a workspace} other {{authorOrAuthors} invited you to a workspace}}",values:{numberOfAuthors:i.length,authorOrAuthors:a},id:"activity.userInvitedActivityOtherInvite.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});default:(0,C.t1)(t)}}function mi(e){let{data:t,authors:i,isFromBot:o,activity:r,tabArgs:a,getRecordModel:s,spaceId:d}=e;const c=(0,E.VK)((()=>Le(i)),[i]);switch(t.type){case"block":const e=t.block,l=n()(Rt,{tabArgs:a,titledRecordStore:e,activity:r,getRecordModel:s});return n()(J.FormattedMessage,o?{defaultMessage:"You have been invited to {blockName}",values:{blockName:l},id:"activity.userInvitedActivityNavigableBlockByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to {blockName}} other {{authorOrAuthors} invited you to {blockName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:c,blockName:l},id:"activity.userInvitedActivityNavigableBlock.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case"group":const h=n()(oi,{permissionGroup:t.group,spaceId:d});return n()(J.FormattedMessage,o?{defaultMessage:"You have been added to group {groupName}",values:{groupName:h},id:"activity.userInvitedActivityGroupIdByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} added you to group {groupName}} other {{authorOrAuthors} added you to group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:c,groupName:h},id:"activity.userInvitedActivityGroupId.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});case"space":const u=n()(Rt,{tabArgs:a,titledRecordStore:t.space,activity:r,getRecordModel:s});return n()(J.FormattedMessage,o?{defaultMessage:"You have been invited to {spaceName}",values:{spaceName:u},id:"activity.userInvitedActivityOtherInviteByBot.header"}:{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} invited you to {spaceName}} other {{authorOrAuthors} invited you to {spaceName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:c,spaceName:u},id:"activity.userInvitedActivityOtherInvite.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});default:(0,C.t1)(t)}}function vi(e){let{edit:t,activity:i,rootStore:o,tabArgs:r}=e;window.__c={n:"InviteDetail"};const a=(0,U.O7)(),{isMobile:s}=a.device,{source:d}=r,c=(0,F.yK)((()=>({inviteMessage:{paddingLeft:mt({source:d,isMobile:s}),paddingTop:8,paddingBottom:8,paddingRight:12,fontSize:14}})),[s,d]),l=fi({rootStore:o,edit:t}),h=parseInt(i.end_time),u=(0,E.VK)((()=>{if("block"!==(null==l?void 0:l.type))return;const e=l.block;return null!=e&&e.isDefined()?e.getModel():void 0}),[l]),p=(0,E.VK)((()=>{if(u)return at(u.getRenderUrl({getRecordModel:o.getRecordModel}))}),[u,o.getRecordModel]),g=(0,E.VK)((()=>{if(!u)return{isValid:!1};const e=u&&(0,di.$e)(u,i);if(!e)return{isValid:!1};const t=o.getRecordValue({table:si.Tu,id:e,spaceId:i.space_id});return null!=t&&t.message&&t.created_time<=h+5*ci.hM?{isValid:!0,message:t.message}:{isValid:!1}}),[i,h,u,o]);return null!=g&&g.isValid?n()(kt.Z,{href:p,onClick:()=>nt({...r,environment:a,activity:i,mightCloseTab:!0}),innerStyle:c.inviteMessage},void 0,g.message):null}function fi(e){let{rootStore:t,edit:i}=e;return(0,E.VK)((()=>{if(i)return i.navigable_block_id?{type:"block",block:Z.G.createChildStore(t,{table:S.iU,id:i.navigable_block_id})}:i.permission_group_id?{type:"group",group:(0,b.Bg)({spaceId:i.space_id,permissionGroupId:i.permission_group_id,getRecordValue:t.getRecordValue})}:{type:"space",space:Z.H2.createChildStore(t,{table:O.bx,id:i.space_id})}}),[i,t])}const bi=c.memo(ui);function yi(e){const{activity:t,rootStore:i,tabArgs:o,isLast:a,useRedesignedIA:s}=e,{source:d,tab:l,notification:h}=o,u=(0,U.O7)(),p=t.edits??[],g=p.length>0,m=p[0],v=Z.G.createChildStore(i,{table:S.iU,id:m.navigable_block_id}),f=(0,E.VK)((()=>v.isDefined()),[v]),b=Z.G.createChildStore(i,{table:S.iU,id:t.mentioned_block_id}),y=(0,E.VK)((()=>b.isDefined()),[b]),A=(0,E.VK)((()=>{const e=b.getModel();return null==e?void 0:e.getRenderUrl({getRecordModel:i.getRecordModel})}),[b,i]),M=(0,E.VK)((()=>xe({edits:t.edits||[],rootStore:i})),[t,i]),k=(0,E.VK)((()=>Le(M)),[M]),w=(0,E.VK)((()=>Ue({recordId:v.id,recordType:"block",tab:l,rootStore:i,environment:u})),[v,l,i,u]);if(!(g&&f&&y&&A))return null;const _=at(A),O=u.device.isMobile,T=n()(Rt,{titledRecordStore:v,getRecordModel:i.getRecordModel,activity:t,tabArgs:o});return s?c.createElement(Ae,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in a page} other {{authorOrAuthors} mentioned you in a page}}",values:{numberOfAuthors:M.length,authorOrAuthors:k},id:"activity.mentionActivity.standardizedHeader",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:a,isPrivate:w,rootStore:i,navigableBlockId:v.id,prominentTitleLink:T,notification:h,icon:n()(pe,{authors:M}),showSnapshotButton:!1},ct({notification:h,activity:t,environment:u,tab:l})),n()(kt.Z,{href:_,onClick:()=>nt({environment:u,activity:t,...o}),innerStyle:gt({source:d,isMobile:O})},void 0,n()(Vt.Z,{edit:m,rootStore:i})),n()(yt,{notification:h,activity:t,source:d,tab:l,isMobile:O,environment:u,rootStore:i})):c.createElement(ve,r()({timestamp:parseInt(t.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} mentioned you in {pageName}} other {{authorOrAuthors} mentioned you in {pageName}}}",values:{numberOfAuthors:M.length,authorOrAuthors:k,pageName:T},id:"activity.mentionActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:a,isPrivate:w,rootStore:i,navigableBlockId:v.id,notification:h,icon:n()(pe,{authors:M}),showSnapshotButton:!1},ct({notification:h,activity:t,environment:u,tab:l})),n()(kt.Z,{href:_,onClick:()=>nt({environment:u,activity:t,...o}),innerStyle:gt({source:d,isMobile:O})},void 0,n()(Vt.Z,{edit:m,rootStore:i})),n()(yt,{notification:h,activity:t,source:d,tab:l,isMobile:O,environment:u,rootStore:i}))}var Si=i(80951);function Ai(e){const{activity:t,rootStore:i,tabArgs:o,isLast:a,useRedesignedIA:s}=e,{tab:d,source:l,notification:h}=o,u=(0,U.O7)(),p=Z.G.createChildStore(i,{table:S.iU,id:t.navigable_block_id}),g=(0,E.VK)((()=>p.isDefined()),[p]),m=Z.NW.createChildStore(i,{table:M.v,id:t.collection_id,spaceId:t.space_id}),v=(0,E.VK)((()=>m.isDefined()),[m]),f=(0,E.VK)((()=>{const e=m.getSchema(),t=Object.keys(e).find((t=>{var i;return"verification"===(null===(i=e[t])||void 0===i?void 0:i.type)}));let o=n()(J.FormattedMessage,{id:"Activity.author.unknown",defaultMessage:"Unknown",description:"Label for a user when the user info is unknown for some reason"});if(t){const e=p.getPropertyValue(t),r=Si._w(e);if(r){const e=Ze(r[0],i);e&&e.value&&(o=Le([e]))}}return o}),[p,m,i]),b=(0,E.VK)((()=>Ue({recordId:p.id,recordType:"block",tab:d,rootStore:i,environment:u})),[p,d,i,u]);if(!g||!v)return null;const y=n()(Rt,{titledRecordStore:p,getRecordModel:i.getRecordModel,activity:t,tabArgs:o}),A=n()(J.FormattedMessage,{defaultMessage:"Verification expired for <boldtext>{pageTitle}</boldtext>",values:{pageTitle:y,boldtext:e=>n()("span",{style:{fontWeight:500}},void 0,e)},id:"activity.verificationExpired.header",description:"Notification header for when verification for a page has expired."}),k=parseInt(t.start_time),w=parseInt(t.end_time),_=u.device.isMobile,O=n()("div",{style:{fontSize:14,...gt({source:l,isMobile:_})}},void 0,n()(J.FormattedMessage,k&&w?{defaultMessage:"Last verified by {person} from {startDate} to {endDate}",values:{person:f,startDate:(0,Q.gs)(parseInt(t.start_time)),endDate:(0,Q.gs)(parseInt(t.end_time))},id:"activity.verificationExpired.contentWithTimestamp",description:"Notification content for when verification for a page has expired, to show who last verified it and when."}:{defaultMessage:"Last verified by {person}",values:{person:f},id:"activity.verificationExpired.contentWithoutTimestamp",description:"Notification content for when verification for a page has expired, to show who last verified it."}));return s?c.createElement(Ae,r()({timestamp:parseInt(t.end_time),header:A,isLast:a,isPrivate:b,rootStore:m,navigableBlockId:t.navigable_block_id,notification:h,icon:n()(me,{}),showSnapshotButton:!1},ct({notification:h,activity:t,environment:u,tab:d})),O,n()(yt,{notification:h,activity:t,source:l,tab:d,isMobile:u.device.isMobile,environment:u,rootStore:i})):c.createElement(ve,r()({timestamp:parseInt(t.end_time),header:A,isLast:a,isPrivate:b,rootStore:m,navigableBlockId:t.navigable_block_id,notification:h,icon:n()(me,{}),showSnapshotButton:!1},ct({notification:h,activity:t,environment:u,tab:d})),O,n()(yt,{notification:h,activity:t,source:l,tab:d,isMobile:u.device.isMobile,environment:u,rootStore:i}))}var Mi=i(1136),ki=i(45669);class wi extends l.Z{constructor(e){super(e),this.renderBlockEdit=(e,t,i)=>{let o=this.getRecordValue({table:S.iU,id:e.block_id});o&&o.type===m.Ti.tableRow&&(o=this.getRecordValue({table:S.iU,id:o.parent_id}));const r=o?this.withPageVisitSource(f.kk.fromBlock(o).getRenderUrl({getRecordModel:this.getRecordModel})):y._j.root;return"block-deleted"===e.type?e.block_data.block_value.type===m.Ti.page?n()(kt.Z,{href:r,onClick:()=>this.trackBodyClick(),innerStyle:this.getEditButtonStyle()},t,n()(Vt.Z,{edit:e,rootStore:this.props.rootStore})):n()("div",{style:this.getEditButtonStyle()},t,n()(Vt.Z,{edit:e,rootStore:this.props.rootStore})):n()(kt.Z,{href:r,onClick:()=>this.trackBodyClick(),innerStyle:this.getEditButtonStyle()},t,n()(Vt.Z,{edit:e,rootStore:this.props.rootStore}))},this.renderCollectionPropertyEdit=(e,t)=>{if("collection-property-changed"===e.type)return n()(kt.Z,{href:t,innerStyle:this.getEditButtonStyle()},void 0,n()(Vt.Z,{edit:e,rootStore:this.props.rootStore}))},this.handleUnarchive=()=>{const{tabArgs:e,rootStore:t}=this.props,{notification:i}=e;i&&(V.createAndCommit({userAction:"Activity.handleUnarchive",environment:this.environment,perform:e=>{P.E1({notificationId:i.id,visited:!1,rootStore:t,transaction:e})}}),N.F5(this.getBaseNotificationArgs()))},this.getRecordStore=e=>this.props.rootStore.getRecordStore(this.props.rootStore,e),this.getUserValue=e=>Z.U6.createChildStore(this.props.rootStore,{table:T.KJ,id:e}).getValue(),this.getBotValue=e=>(0,Z.Kv)(this.props.rootStore,{table:A.cZ,id:e}).getValue(),this.getAuthorActor=e=>{if(e.table===T.KJ){const t=this.getUserValue(e.id);if(t)return(0,u.dp)(t)}else{const t=this.getBotValue(e.id);if(t)return(0,u.D$)(t)}},this.getSpaceStore=e=>Z.H2.createChildStore(this.props.rootStore,{table:O.bx,id:e}),this.handleMarkAsUnreadClicked=()=>{N.u_(this.getBaseNotificationArgs())},this.getDiscussionContext=()=>{const e=Ee({activity:this.props.activity,rootStore:this.props.rootStore});if(e)return e.context},this.handleTrackBacklinkClick=this.handleTrackBacklinkClick.bind(this),this.handleTrackArchiveClicked=this.handleTrackArchiveClicked.bind(this),this.handleNotificationFrameClicked=this.handleNotificationFrameClicked.bind(this),this.handleMarkAsReadClicked=this.handleMarkAsReadClicked.bind(this)}willMountOrUpdate(){this.warmCommentData(),this.environment.KatexStore.loadIfNeeded(this.getDiscussionContext)}warmCommentData(){if("commented"===this.props.activity.type){const e=this.getRecordStore({table:_.qF,id:this.props.activity.discussion_id,spaceId:this.props.activity.space_id});if(e.isDefined()){const t=e.getCommentStores();for(const e of t)if(e.isDefined()&&e.getCreatedByTable()&&e.getCreatedById()){this.getRecordStore(e.getCreatedByPointer()).load()}}}}renderComponent(){const{activity:e,rootStore:t,tabArgs:i,isLast:o,isTopbarUpdatesMenu:r,useRedesignedIA:a}=this.props;switch(e.type){case"block-edited":return this.renderBlockEditActivity(e);case"block-property-edited":return n()(Kt,{activity:e,rootStore:t,tabArgs:i,isLast:o,isTopbarUpdatesMenu:r,useRedesignedIA:a});case"collection-row-created":case"collection-row-deleted":return this.renderCollectionRowActivity(e);case"top-level-block-created":case"top-level-block-deleted":return this.renderTopLevelBlockActivity(e);case"permissions-edited":return this.renderPermissionsActivity(e);case"permission-group-edited":return this.renderPermissionGroupActivity(e);case"user-mentioned":return n()(yi,{activity:e,rootStore:t,tabArgs:i,isLast:o,isTopbarUpdatesMenu:r,useRedesignedIA:a});case"commented":return n()(Xt,{activity:e,tabArgs:i,rootStore:t,isLast:o,useRedesignedIA:a});case"user-invited":return n()(bi,{activity:e,rootStore:t,tabArgs:i,isLast:o,useRedesignedIA:a});case"collection-edited":return this.renderCollectionEdited(e);case"collection-view-edited":return this.renderCollectionViewEdited(e);case"collection-property-edited":return this.renderCollectionPropertyEdited(e);case"reminder":return n()(ai,{activity:e,rootStore:t,tabArgs:i,isLast:o,isTopbarUpdatesMenu:r,useRedesignedIA:a});case"page-locked":case"page-unlocked":return this.renderPageLockActivity(e);case"email-edited":return n()(Qt,{activity:e,rootStore:t,tabArgs:i,isLast:o,isTopbarUpdatesMenu:r,useRedesignedIA:a});case"access-requested":return n()(Pt,{activity:e,rootStore:t,tabArgs:i,isLast:o,useRedesignedIA:a});case"page-deleted":case"page-restored":case"page-permanently-deleted":return this.renderPageDeleteOrRestoreActivity(e);case"team-membership-edited":return n()(ni,{activity:e,rootStore:t,tabArgs:i,isLast:o,useRedesignedIA:a});case"private-content-transferred":return n()(ri,{activity:e,rootStore:t,tabArgs:i,isLast:o,useRedesignedIA:a});case"permission-group-mentioned":return n()(ti,{activity:e,rootStore:t,tabArgs:i,isLast:o,useRedesignedIA:a});case"verification-expired":return n()(Ai,{activity:e,rootStore:t,tabArgs:i,isLast:o,useRedesignedIA:a});default:(0,C.t1)(e)}}withPageVisitSource(e){return(0,B.SK)(e,{[p.$X]:p.tY.Notification})}renderBlockEditActivity(e){if(!e.edits)return;const t=(0,R.hI)(e.edits).filter((e=>{const{block_value:t}="block-changed"===e.type?e.block_data.after:e.block_data;return t.parent_table!==w.x_}));if(0===t.length)return;const i=this.getBlockStore(t[0].navigable_block_id);if(!i.isDefined())return;const o=this.getAuthors(t),a=Le(o),s=this.renderTitle(i);return c.createElement(ve,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {pageTitle}} other {{authorOrAuthors} edited {pageTitle}}}",id:"activity.blockEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)",values:{numberOfAuthors:o.length,authorOrAuthors:a,pageTitle:s}})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:o}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),n()(Zt,{visible:5,items:t.map(this.renderBlockEdit)}),this.renderNotificationActions())}renderCollectionRowActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(e.collection_row_id);if(!i.isDefined())return;if(!i.getProperties())return;const o=this.getAuthors(e.edits),a=Le(o),s=this.renderTitle(i),d="collection-row-created"===t.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created {pageTitle}} other {{authorOrAuthors} created {pageTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:a,pageTitle:s},id:"activity.collectionRowCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted {pageTitle}} other {{authorOrAuthors} deleted {pageTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:a,pageTitle:s},id:"activity.collectionRowDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return c.createElement(ve,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,d),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:o}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderTopLevelBlockActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(e.top_level_block_id);if(!i.isDefined())return;const o=i.hasSpacePermission(),a=this.getAuthors(e.edits),s=Le(a),d=this.renderTitle(i);let l;return l=o?"top-level-block-created"===t.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created workspace page {pageTitle}} other {{authorOrAuthors} created workspace page {pageTitle}}}",values:{numberOfAuthors:a.length,authorOrAuthors:s,pageTitle:d},id:"activity.topLevelBlockWorkspaceCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted workspace page {pageTitle}} other {{authorOrAuthors} deleted workspace page {pageTitle}}}",values:{numberOfAuthors:a.length,authorOrAuthors:s,pageTitle:d},id:"activity.topLevelBlockWorkspaceDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"top-level-block-created"===t.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created private page {pageTitle}} other {{authorOrAuthors} created private page {pageTitle}}}",values:{numberOfAuthors:a.length,authorOrAuthors:s,pageTitle:d},id:"activity.topLevelBlockPrivateCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted private page {pageTitle}} other {{authorOrAuthors} deleted private page {pageTitle}}}",values:{numberOfAuthors:a.length,authorOrAuthors:s,pageTitle:d},id:"activity.topLevelBlockPrivateDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),c.createElement(ve,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,l),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),rootStore:this.props.rootStore,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:a}),showSnapshotButton:!1},this.getActivitySectionHandlers()))}renderPermissionsActivity(e){if(!e.edits)return;const t=(0,R.hI)(e.edits);if(0===t.length)return;let i,o;const a=t[0];if(a.navigable_block_id){const e=this.getBlockStore(a.navigable_block_id);if(!e.isDefined())return;o=this.renderTitle(e),i=this.getIsRecordPrivateToUser(e.id,"block")}else{const e=this.getSpaceStore(a.space_id);if(!e.isDefined())return;o=this.renderTitle(e),i=this.getIsRecordPrivateToUser(a.space_id,"space")}const{autojoinEdits:s,inheritanceEdits:d,otherEdits:l}=h.md(e.edits),u=[];s.forEach(((e,t)=>{const a=this.getAuthors([e]),s=Le(a);u.push(c.createElement(ve,r()({key:`autojoin-${t}`,timestamp:e.timestamp,header:n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} joined {pageOrSpaceName}} other {{authorOrAuthors} joined {pageOrSpaceName}}}",values:{numberOfAuthors:a.length,authorOrAuthors:s,pageOrSpaceName:o},id:"activity.permissionsActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),isLast:this.props.isLast,isPrivate:i,rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:a}),showSnapshotButton:!1},this.getActivitySectionHandlers())))})),d.forEach(((t,a)=>{const s=this.getAuthors([t]),d=Le(s);let l;"permission-restriction-created"===t.type?l=n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restricted access for {pageOrSpaceName}} other {{authorOrAuthors} restricted access for {pageOrSpaceName}}}{inSudoMode, select, true { using administrator privileges} other {}}",values:{numberOfAuthors:s.length,authorOrAuthors:d,pageOrSpaceName:o,inSudoMode:t.inSudoMode},id:"activity.restrictPermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"permission-restriction-deleted"===t.type&&(l=n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restored inherited access for {pageOrSpaceName}} other {{authorOrAuthors} restored inherited access for {pageOrSpaceName}}}{inSudoMode, select, true { using administrator privileges} other {}}",values:{numberOfAuthors:s.length,authorOrAuthors:d,pageOrSpaceName:o,inSudoMode:t.inSudoMode},id:"activity.restorePermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})),u.push(c.createElement(ve,r()({key:`inheritance-${a}`,timestamp:parseInt(e.end_time),header:n()("span",{},void 0,l),isLast:this.props.isLast,isPrivate:i,rootStore:this.props.rootStore,navigableBlockId:t.navigable_block_id,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:s}),showSnapshotButton:!1},this.getActivitySectionHandlers()),n()("div",{style:this.getEditButtonStyle()},void 0,n()(Vt.Z,{edit:t,rootStore:this.props.rootStore})),this.renderNotificationActions()))}));const p=(t,o,s)=>{if(t.length>0){const d=this.getAuthors(t);u.push(c.createElement(ve,r()({key:o,timestamp:parseInt(e.end_time),header:s,isLast:this.props.isLast,isPrivate:i,rootStore:this.props.rootStore,navigableBlockId:a.navigable_block_id,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:d}),showSnapshotButton:!1},this.getActivitySectionHandlers()),t.map(((e,t,i)=>n()("div",{style:this.getEditButtonStyle()},t,n()(Vt.Z,{edit:e,rootStore:this.props.rootStore},t)))),this.renderNotificationActions()))}},g=l.filter((e=>!e.inSudoMode));if(g.length>0){const e=this.getAuthors(g),t=Le(e);p(g,"other",n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated permission for {pageOrSpaceName}} other {{authorOrAuthors} updated permission for {pageOrSpaceName}}}",values:{numberOfAuthors:e.length,authorOrAuthors:t,pageOrSpaceName:o},id:"activity.updatedPermissionsForActivity.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})))}const m=l.filter((e=>e.inSudoMode));if(m.length>0){const e=this.getAuthors(m),t=Le(e);p(m,"other-sudo",n()("span",{},void 0,n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} updated permission for {pageOrSpaceName}} other {{authorOrAuthors} updated permission for {pageOrSpaceName}}} using administrator privileges",values:{numberOfAuthors:e.length,authorOrAuthors:t,pageOrSpaceName:o},id:"activity.updatedPermissionsForActivityInSudoMode.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})))}return u}renderPermissionGroupActivity(e){if(!e.edits)return;const t=(0,R.hI)(e.edits)[0];if(!t)return;const i=this.getSpaceStore(t.space_id);if(!i.isDefined())return;const o=this.withPageVisitSource(i.getModel().getRenderUrl({getRecordModel:this.getRecordModel})),a=n()(oi,{permissionGroup:(0,b.c_)({activity:e,getRecordValue:this.getRecordValue}),spaceId:e.space_id}),s=this.getAuthors(e.edits);return c.createElement(ve,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,this.renderPermissionGroupEditedHeader({activity:e,authors:s,groupName:a})),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.space_id,"space"),rootStore:this.props.rootStore,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:s}),showSnapshotButton:!1},this.getActivitySectionHandlers()),n()(kt.Z,{href:o,onClick:()=>this.trackBodyClick(),innerStyle:this.getEditButtonStyle()},void 0,n()(Vt.Z,{edit:t,rootStore:this.props.rootStore})),this.renderNotificationActions())}renderUnarchiveButton(){return n()(qe.Z,{onClick:this.handleUnarchive,style:this.getActionSecondaryButtonStyle()},void 0,n()(J.FormattedMessage,{defaultMessage:"Unarchive",id:"activity.actions.unarchiveButton.label"}))}renderNotificationActions(){if(this.canUnarchive())return n()("div",{style:this.getActionContainerStyle()},void 0,this.renderUnarchiveButton())}renderCollectionEdited(e){if(!e.edits)return;const t=this.getRecordStore({table:M.v,id:e.collection_id,spaceId:e.space_id});if(!t.isDefined())return;const i=e.edits[0];if(!i)return;const o=this.withPageVisitSource(t.getModel().getRenderUrl({getRecordModel:this.getRecordModel})),a=this.getAuthors(e.edits),s=Le(a),d=this.renderTitle(t),l="collection-created"===i.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created {collectionTitle}} other {{authorOrAuthors} created {collectionTitle}}}",values:{numberOfAuthors:a.length,authorOrAuthors:s,collectionTitle:d},id:"activity.collectionCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited {collectionTitle}} other {{authorOrAuthors} edited {collectionTitle}}}",values:{numberOfAuthors:a.length,authorOrAuthors:s,collectionTitle:d},id:"activity.collectionEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return c.createElement(ve,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,l),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.collection_id,"collection"),rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:a}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),h.OC(i)&&this.renderCollectionDescriptionEdit(i,o),this.renderNotificationActions())}renderCollectionDescriptionEdit(e,t){return n()(kt.Z,{href:t,innerStyle:this.getEditButtonStyle()},void 0,n()(Vt.Z,{edit:e,rootStore:this.props.rootStore}))}renderCollectionViewEdited(e){if(!e.edits)return;const t=this.getRecordStore({table:M.v,id:e.collection_id,spaceId:e.space_id});if(!t.isDefined())return;const i=this.getRecordStore({table:k.n,id:e.collection_view_id,spaceId:e.space_id});if(!i.isDefined())return;const o=(0,R.hI)(e.edits)[0];if(!o)return;const a=this.renderCollectionViewTitle(i),s=this.renderTitle(t),d=this.getAuthors(e.edits),l=Le(d);let h;return h="collection-view-created"===o.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} created view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:s,collectionViewTitle:a},id:"activity.collectionViewCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"collection-view-deleted"===o.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} deleted view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:s,collectionViewTitle:a},id:"activity.collectionViewDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited view {collectionViewTitle} in {collectionTitle}} other {{authorOrAuthors} edited view {collectionViewTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:s,collectionViewTitle:a},id:"activity.collectionViewEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),c.createElement(ve,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,h),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.collection_id,"collection"),rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:d}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderCollectionPropertyEdited(e){if(!e.edits)return;const t=(0,R.hI)(e.edits),i=t[0];if(!i)return;const o=this.getRecordStore({table:M.v,id:e.collection_id,spaceId:e.space_id});if(!o.isDefined())return;const a=this.withPageVisitSource(o.getModel().getRenderUrl({getRecordModel:this.getRecordModel})),s="collection-property-changed"===i.type?i.collection_property_data.after:i.collection_property_data,d=this.getAuthors(e.edits),l=Le(d),h=this.renderTitle(o),u=this.renderCollectionPropertyTitle(s);let p;return p="collection-property-created"===i.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} created property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:h,collectionPropertyTitle:u},id:"activity.collectionPropertyCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"collection-property-deleted"===i.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} deleted property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:h,collectionPropertyTitle:u},id:"activity.collectionPropertyDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited property {collectionPropertyTitle} in {collectionTitle}} other {{authorOrAuthors} edited property {collectionPropertyTitle} in {collectionTitle}}}",values:{numberOfAuthors:d.length,authorOrAuthors:l,collectionTitle:h,collectionPropertyTitle:u},id:"activity.collectionPropertyEdited.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}),c.createElement(ve,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,p),isLast:this.props.isLast,isPrivate:this.getIsRecordPrivateToUser(e.collection_id,"collection"),rootStore:this.props.rootStore,navigableBlockId:e.navigable_block_id,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:d}),showSnapshotButton:this.props.isTopbarUpdatesMenu},this.getActivitySectionHandlers()),n()(Zt,{visible:5,items:t.map((e=>this.renderCollectionPropertyEdit(e,a)))}),this.renderNotificationActions())}renderPageLockActivity(e){if(!e.edits)return;const t=e.edits[0],i=this.getBlockStore(t.navigable_block_id);if(!i.isDefined())return;const o=this.getAuthors(e.edits),a=Le(o),s=this.renderTitle(i),d="page-locked"===e.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} locked {blockTitle}} other {{authorOrAuthors} locked {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:a,blockTitle:s},id:"activity.pageLocked.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} unlocked {blockTitle}} other {{authorOrAuthors} unlocked {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:a,blockTitle:s},id:"activity.pageUnlocked.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"});return c.createElement(ve,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,d),isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),isLast:this.props.isLast,rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:o}),showSnapshotButton:!1},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderPageDeleteOrRestoreActivity(e){if(!e.edits)return;const t=e.edits[0];if(!t)return;const i=this.getRecordStore({table:S.iU,id:t.navigable_block_id,spaceId:t.space_id});if(!i.isDefined())return;const o=this.getAuthors(e.edits),a=Le(o),s=this.renderTitle(i);let d;return"page-deleted"===e.type?d=n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted {blockTitle}} other {{authorOrAuthors} deleted {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:a,blockTitle:s},id:"emailActivity.pageDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"page-restored"===e.type?d=n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} restored {blockTitle}} other {{authorOrAuthors} restored {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:a,blockTitle:s},id:"emailActivity.pageRestored.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"page-permanently-deleted"===e.type?d=n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} permanently deleted {blockTitle}} other {{authorOrAuthors} permanently deleted {blockTitle}}}",values:{numberOfAuthors:o.length,authorOrAuthors:a,blockTitle:s},id:"emailActivity.pagePermanentlyDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):(0,C.t1)(e),c.createElement(ve,r()({timestamp:parseInt(e.end_time),header:n()("span",{},void 0,d),isPrivate:this.getIsRecordPrivateToUser(i.id,"block"),isLast:this.props.isLast,rootStore:this.props.rootStore,navigableBlockId:i.id,notification:this.props.tabArgs.notification,icon:n()(pe,{authors:o}),showSnapshotButton:!1},this.getActivitySectionHandlers()),this.renderNotificationActions())}renderCollectionPropertyTitle(e){const{theme:t}=this;return n()("span",{style:{...wi.boldStyle,whiteSpace:"nowrap"}},void 0,n()(v.ZP,{icon:e.icon,type:e.type,size:12,style:wi.svgIconStyle,theme:t}),e.name)}renderCollectionViewTitle(e){if(!e.isDefined())return;const t=e.getModel().getRenderUrl({getRecordModel:this.getRecordModel}),i=e.getFormat().collection_view_icon,o=e.getType();return n()(kt.Z,{href:t,onClick:()=>this.trackTitleClick(),external:!1,innerStyle:{...wi.pageLinkStyle,...wi.boldStyle},inline:!0},void 0,n()(Mi.F,{viewIcon:i,viewType:o,color:"light",style:{display:"inline-block",verticalAlign:"middle",marginRight:4,marginBottom:2},size:12}),n()(ki.Z,{collectionViewName:e.getName(),collectionViewType:e.getType()}))}renderTitle(e){const t=e.getModel();if(!t)return;const i=t.getRenderIcon({getRecordModel:this.getRecordModel}),o=this.withPageVisitSource(t.getRenderUrl({getRecordModel:this.getRecordModel}));return n()(kt.Z,{href:o,onClick:()=>this.trackTitleClick(),external:!1,innerStyle:wi.pageLinkStyle,inline:!0},void 0,i&&c.createElement(c.Fragment,null,n()(wt.Z,{disabled:!0,icon:i,isEmptyPage:!1,size:18,style:wi.recordIconStyle}),n()("span",{},void 0," ")),n()(_t.Z,{store:e,style:this.getActivityTitleStyle(void 0!==i)}))}renderPermissionGroupEditedHeader(e){const{activity:t,authors:i,groupName:o}=e,r=Le(i),a=(0,R.hI)(t.edits||[])[0];return a?"permission-group-created"===a.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} created group {groupName}} other {{authorOrAuthors} created group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:n()("span",{style:wi.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupCreated.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):"permission-group-deleted"===a.type?n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} deleted group {groupName}} other {{authorOrAuthors} deleted group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:n()("span",{style:wi.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupDeleted.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited group {groupName}} other {{authorOrAuthors} edited group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:n()("span",{style:wi.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupEditedDefault.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"}):n()(J.FormattedMessage,{defaultMessage:"{numberOfAuthors, plural, one {{authorOrAuthors} edited group {groupName}} other {{authorOrAuthors} edited group {groupName}}}",values:{numberOfAuthors:i.length,authorOrAuthors:r,groupName:n()("span",{style:wi.boldStyle},void 0,o)},id:"activity.updatedPermissionGroupEdit.header",description:"Notification header for updates. The authorOrAuthors variable will be either a name (eg John Doe), two names (eg John Doe and Jane Smith), or more than three (eg John Doe, Jane Smith, and 3 others)"})}canUnarchive(){const{tabArgs:e}=this.props,{notification:t}=e;return!!t&&!!t.visited}get getRecordValue(){return this.props.rootStore.getRecordValue}get getRecordModel(){return this.props.rootStore.getRecordModel}getBlockStore(e){return Z.G.createChildStore(this.props.rootStore,{table:S.iU,id:e})}getAuthors(e){const t=d().uniqWith(d().flatten(e.map((e=>e.authors||[]))),d().isEqual);return d().compact(t.map(this.getAuthorActor))}handleTrackBacklinkClick(e){N.EQ({...this.getBaseNotificationArgs(),backlinkPageId:e})}handleTrackArchiveClicked(){N._b(this.getBaseNotificationArgs())}handleNotificationFrameClicked(){N.ix(this.getBaseNotificationArgs())}handleMarkAsReadClicked(){N.cC(this.getBaseNotificationArgs())}getBaseNotificationArgs(){const{tabArgs:e,activity:t}=this.props,{notification:i,tab:o}=e;return{environment:this.environment,activity:t,notificationId:null==i?void 0:i.id,alreadyRead:Boolean(null==i?void 0:i.read),tab:o}}getActivitySectionHandlers(){return{onBacklinkClicked:this.handleTrackBacklinkClick,onArchiveClicked:this.handleTrackArchiveClicked,onMarkAsReadClicked:this.handleMarkAsReadClicked,onMarkAsUnreadClicked:this.handleMarkAsUnreadClicked,onNotificationFrameClicked:this.handleNotificationFrameClicked}}trackTitleClick(){this.trackClick({target:"title",tabArgs:this.props.tabArgs,mightCloseTab:!0})}trackBodyClick(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{mightCloseTab:!0};const{mightCloseTab:t}=e;this.trackClick({target:"body",tabArgs:this.props.tabArgs,mightCloseTab:t})}trackClick(e){const{target:t,tabArgs:i,mightCloseTab:o}=e,{notification:r,source:a,tab:n}=i,s="notifications_tab"===a?K.ZP.state.sessionId:void 0,d="notifications_tab"===a?K.ZP.isFilteredToUnreadOnly():void 0;D.trackClickUpdate(this.environment,{target:t,activity_id:this.props.activity.id,notification_id:null==r?void 0:r.id,sessionId:s,is_filtered:d,tab:n}),o&&N.pw({environment:this.environment,target:t}),r&&g.e((0,x.getClientEventTracker)(this.environment),{alreadyRead:r.read,notificationId:r.id,activityId:r.activity_id,from:t,sessionId:s})}getIsRecordPrivateToUser(e,t){const{tabArgs:i}=this.props;if("notifications_tab"!==i.source)return!1;if("all"!==i.tab)return!1;if(!e)return!1;let o;return o="block"===t?Z.G.createChildStore(this.props.rootStore,{table:S.iU,id:e}):"collection"===t?Z.NW.createChildStore(this.props.rootStore,{table:M.v,id:e}):Z.H2.createChildStore(this.props.rootStore,{table:O.bx,id:e}),(0,L.yi)(this.environment,o)}getActionContainerStyle(){return{paddingLeft:this.getActivityContentLeftPadding()-8,paddingTop:4}}getEditButtonStyle(){return{padding:0,paddingLeft:this.getActivityContentLeftPadding(),paddingRight:16,...wi.canSelectStyle}}getActivityContentLeftPadding(){return this.isInboxTab()?52+(this.environment.device.isMobile?3:2):52}isInboxTab(){return"notifications_tab"===this.props.tabArgs.source&&"inbox"===this.props.tabArgs.tab}getActionSecondaryButtonStyle(){return{height:26,paddingLeft:8,paddingRight:8,color:this.theme.mediumTextColor}}getActivityTitleStyle(e){return{display:"inline",whiteSpace:"normal",marginRight:e?3:0,wordBreak:"break-word",...wi.boldStyle}}}wi.displayName="Activity",wi.canSelectStyle={userSelect:"text",WebkitUserSelect:"text"},wi.boldStyle={fontWeight:I.Z.fontWeight.semibold},wi.pageLinkStyle={padding:1,...wi.canSelectStyle},wi.recordIconStyle={display:"inline-flex",marginRight:2,verticalAlign:"text-top"},wi.svgIconStyle={width:12,height:12,display:"inline-block",verticalAlign:"middle",marginBottom:2,marginRight:4};const _i=wi},98905:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(49085);class r extends o.Z{getInitialState(){return{count:0}}}const a=new r}}]);